{"version":3,"file":"orderPage.js","sources":["secondPages/orderPage/orderPage.vue","E:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c2Vjb25kUGFnZXNcb3JkZXJQYWdlXG9yZGVyUGFnZS52dWU"],"sourcesContent":["<template>\r\n\t<pageBack :titleInfo=\"titleInfo\"></pageBack>\r\n\t<view class=\"content\">\r\n\t\t<view class=\"payMoney\">\r\n\t\t\t<view>\r\n\t\t\t\t\t{{ grid === '公益' ? '捐赠所需金额' : '兑换所需香火值' }}\r\n\t\t\t</view>\r\n\t\t\t<view class=\"money\">\r\n\t\t\t\t\t<text>{{ grid === '公益' ? '金额' : '香火值' }}</text>{{price}}\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"payToast\">\r\n\t\t\t30分钟内未兑换系统将自动取消订单\r\n\t\t</view>\r\n\t\t<view class=\"payMent\">\r\n\t\t\t<view class=\"mentItem\" v-for=\"item in patMent\" :class=\"{ active: currentPaymentMethod === item.id }\"\r\n\t\t\t\t@click=\"selectPaymentMethod(item.id)\">\r\n\t\t\t\t<image :src=\"item.svg\" mode=\"\"></image>\r\n\t\t\t\t<view class=\"ment\">\r\n\t\t\t\t\t{{item.name}}\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"radio\" :class=\"{ 'active': currentPaymentMethod === item.id }\"></view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"payButton\">\r\n\t\t\t<view class=\"\" @click=\"confirmPay\">\r\n\t\t\t\t确认支付\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport pageBack from \"/components/title/title.vue\";\r\n\timport {\r\n\t\tuseUserInfoStore\r\n\t} from \"/store/userInfo.js\"\r\n\timport {\r\n\t\tshopPayMoneyAPI\r\n\t} from \"../../apis/shop.js\"\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttitleInfo: {\r\n\t\t\t\t\ttitleShow: true,\r\n\t\t\t\t\ttitle: \"兑换\",\r\n\t\t\t\t\timageUrl: \"http://t73sifiwt.hn-bkt.clouddn.com/pageBack/1.webp\",\r\n\t\t\t\t\theightShow: false,\r\n\t\t\t\t\tbackShow: true\r\n\t\t\t\t},\r\n\t\t\t\tpatMent: [{\r\n\t\t\t\t\tid: 1,\r\n\t\t\t\t\tname: `香火值兑换（可用：${useUserInfoStore().$state.userInfo.balance}）`,\r\n\t\t\t\t\tsvg: \"/static/shopPay.svg\"\r\n\t\t\t\t}],\r\n\t\t\t\tprice: null,\r\n\t\t\t\torder_id: null,\r\n\t\t\t\tgrid: null,\r\n\t\t\t\tcurrentPaymentMethod: 1\r\n\t\t\t};\r\n\t\t},\r\n\t\tcomponents: {\r\n\t\t\tpageBack\r\n\t\t},\r\n\t\tonLoad(options) {\r\n\t\t\tthis.price = options.price\r\n\t\t\tthis.order_id = options.order_id\r\n\t\t\tthis.grid = options.grid\r\n\t\t\t// 根据商品类型更新页面文本\r\n\t\t\tif (this.grid === '公益') {\r\n\t\t\t\tthis.titleInfo.title = '捐赠'\r\n\t\t\t\tthis.patMent[0].name = `金额捐赠`\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tselectPaymentMethod(id) {\r\n\t\t\t\tthis.currentPaymentMethod = id;\r\n\t\t\t},\r\n\t\t\t// 支付按钮\r\n\t\t\tconfirmPay() {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: this.grid === '公益' ? \"捐赠中\" : \"兑换中\",\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t// 公益商品特殊处理：直接成功，等价增加用户香火值\r\n\t\t\t\t\tif (this.grid === '公益') {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t// 等价增加用户香火值（捐赠金额=增加的香火值）\r\n\t\t\t\t\t\tconst store = useUserInfoStore();\r\n\t\t\t\t\t\tconst donatedAmount = Number(this.price);\r\n\t\t\t\t\t\tstore.$state.userInfo.balance = Number(store.$state.userInfo.balance || 0) + donatedAmount;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: \"捐赠成功\",\r\n\t\t\t\t\t\t\tmask: true\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\t\t\t\tdelta: 1\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}, 1000)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// 普通商品原有逻辑\r\n\t\t\t\t\t\tswitch (this.currentPaymentMethod) {\r\n\t\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\t\t\tshopPayMoneyAPI({\r\n\t\t\t\t\t\t\t\t\tpay_money: this.price,\r\n\t\t\t\t\t\t\t\t\tpay_ment: this.currentPaymentMethod,\r\n\t\t\t\t\t\t\t\t\torder_id: this.order_id,\r\n\t\t\t\t\t\t\t\t\tuser_id: useUserInfoStore().$state.userInfo.id\r\n\t\t\t\t\t\t\t\t}).then((res) => {\r\n\t\t\t\t\t\t\t\t\tif (res.status == 200) {\r\n\t\t\t\t\t\t\t\t\t\t// 更新pinia数据\r\n\t\t\t\t\t\t\t\t\t\tuseUserInfoStore().$state.userInfo.balance = res.new_balance\r\n\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: res.message,\r\n\t\t\t\t\t\t\t\t\t\t\tmask: true\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\t\t\t\t\t\t\t\tdelta: 1\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t}, 1000)\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: res.message,\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\t\t\tmask: true\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: \"未知错误 请联系管理员\",\r\n\t\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 1000)\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\t.content {\r\n\t\tpadding-bottom: 200rpx;\r\n\t\tposition: relative;\r\n\t\ttop: 200rpx;\r\n\t\twidth: 100%;\r\n\t\tmin-height: 300rpx;\r\n\t\tbackground-color: rgb(255, 251, 241);\r\n\t\tborder-radius: 40rpx 40rpx 0 0;\r\n\t\toverflow: hidden;\r\n\t\tpadding: 20rpx 0;\r\n\t\tfont-family: \"阿里妈妈方圆体 VF Regular\" !important;\r\n\r\n\t\t.payMoney {\r\n\t\t\ttext-align: center;\r\n\t\t\tpadding: 40rpx 0;\r\n\r\n\t\t\t.money {\r\n\t\t\t\tpadding: 20rpx 0;\r\n\t\t\t\tfont-size: 56rpx;\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t\tletter-spacing: 4rpx;\r\n\r\n\t\t\t\ttext {\r\n\t\t\t\t\tfont-size: 40rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.payToast {\r\n\t\t\ttext-align: center;\r\n\t\t\tcolor: rgb(140, 0, 0);\r\n\t\t}\r\n\r\n\t\t.payMent {\r\n\t\t\twidth: 80%;\r\n\t\t\tmargin: auto;\r\n\r\n\t\t\t.mentItem {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: space-between;\r\n\t\t\t\theight: 100rpx;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tborder-bottom: 2rpx solid rgba(0, 0, 0, 0.1);\r\n\t\t\t\tpadding: 20rpx 0;\r\n\r\n\t\t\t\t&.active {\r\n\t\t\t\t\t.radio {\r\n\t\t\t\t\t\t&.active {\r\n\t\t\t\t\t\t\tbackground-color: #4d0000;\r\n\t\t\t\t\t\t\tborder-color: #4d0000;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\timage {\r\n\t\t\t\t\twidth: 60rpx;\r\n\t\t\t\t\theight: 60rpx;\r\n\t\t\t\t\tborder-radius: 100%;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.ment {\r\n\t\t\t\t\twidth: 70%;\r\n\t\t\t\t\ttext-align: left;\r\n\t\t\t\t\tfont-size: 34rpx;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.radio {\r\n\t\t\t\t\twidth: 40rpx;\r\n\t\t\t\t\theight: 40rpx;\r\n\t\t\t\t\tborder: 2rpx solid #000;\r\n\t\t\t\t\tborder-radius: 100%;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.payButton {\r\n\t\t\tpadding: 40rpx 0;\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 160rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\r\n\t\t\tview {\r\n\t\t\t\twidth: 70%;\r\n\t\t\t\theight: 100rpx;\r\n\t\t\t\tbackground-color: #4d0000;\r\n\t\t\t\tcolor: #fff;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tborder-radius: 20rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'C:/Users/18706/Desktop/MZ/mazu-前端小程序/secondPages/orderPage/orderPage.vue'\nwx.createPage(MiniProgramPage)"],"names":["useUserInfoStore","uni","shopPayMoneyAPI"],"mappings":";;;;AAiCC,iBAAiB,MAAW;AAO5B,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,WAAW;AAAA,QACV,WAAW;AAAA,QACX,OAAO;AAAA,QACP,UAAU;AAAA,QACV,YAAY;AAAA,QACZ,UAAU;AAAA,MACV;AAAA,MACD,SAAS,CAAC;AAAA,QACT,IAAI;AAAA,QACJ,MAAM,YAAYA,eAAgB,iBAAA,EAAG,OAAO,SAAS,OAAO;AAAA,QAC5D,KAAK;AAAA,MACN,CAAC;AAAA,MACD,OAAO;AAAA,MACP,UAAU;AAAA,MACV,MAAM;AAAA,MACN,sBAAsB;AAAA;EAEvB;AAAA,EACD,YAAY;AAAA,IACX;AAAA,EACA;AAAA,EACD,OAAO,SAAS;AACf,SAAK,QAAQ,QAAQ;AACrB,SAAK,WAAW,QAAQ;AACxB,SAAK,OAAO,QAAQ;AAEpB,QAAI,KAAK,SAAS,MAAM;AACvB,WAAK,UAAU,QAAQ;AACvB,WAAK,QAAQ,CAAC,EAAE,OAAO;AAAA,IACxB;AAAA,EACA;AAAA,EACD,SAAS;AAAA,IACR,oBAAoB,IAAI;AACvB,WAAK,uBAAuB;AAAA,IAC5B;AAAA;AAAA,IAED,aAAa;AACZC,oBAAAA,MAAI,YAAY;AAAA,QACf,OAAO,KAAK,SAAS,OAAO,QAAQ;AAAA,QACpC,MAAM;AAAA,MACP,CAAC;AACD,iBAAW,MAAM;AAEhB,YAAI,KAAK,SAAS,MAAM;AACvBA,wBAAG,MAAC,YAAW;AAEf,gBAAM,QAAQD,eAAAA;AACd,gBAAM,gBAAgB,OAAO,KAAK,KAAK;AACvC,gBAAM,OAAO,SAAS,UAAU,OAAO,MAAM,OAAO,SAAS,WAAW,CAAC,IAAI;AAE7EC,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,MAAM;AAAA,WACN;AACD,qBAAW,MAAM;AAChBA,0BAAAA,MAAI,aAAa;AAAA,cAChB,OAAO;AAAA,aACP;AAAA,UACD,GAAE,GAAI;AAAA,eACD;AAEN,kBAAQ,KAAK,sBAAoB;AAAA,YAChC,KAAK;AACJC,wCAAgB;AAAA,gBACf,WAAW,KAAK;AAAA,gBAChB,UAAU,KAAK;AAAA,gBACf,UAAU,KAAK;AAAA,gBACf,SAASF,eAAgB,iBAAA,EAAG,OAAO,SAAS;AAAA,cAC7C,CAAC,EAAE,KAAK,CAAC,QAAQ;AAChB,oBAAI,IAAI,UAAU,KAAK;AAEtBA,iCAAAA,iBAAkB,EAAC,OAAO,SAAS,UAAU,IAAI;AACjDC,gCAAAA,MAAI,UAAU;AAAA,oBACb,OAAO,IAAI;AAAA,oBACX,MAAM;AAAA,mBACN;AACD,6BAAW,MAAM;AAChBA,kCAAAA,MAAI,aAAa;AAAA,sBAChB,OAAO;AAAA,qBACP;AAAA,kBACD,GAAE,GAAI;AAAA,uBACD;AACNA,gCAAAA,MAAI,UAAU;AAAA,oBACb,OAAO,IAAI;AAAA,oBACX,MAAM;AAAA,oBACN,MAAM;AAAA,mBACN;AAAA,gBACF;AAAA,eACA;AACD;AAAA,YACD;AACC,qBAAOA,cAAAA,MAAI,UAAU;AAAA,gBACpB,OAAO;AAAA,gBACP,MAAM;AAAA,eACN;AAAA,UAEH;AAAA,QACD;AAAA,MACA,GAAE,GAAI;AAAA,IACP;AAAA,EACD;AAEF;;;;;;;;;;;;;;;;;;;;;;;;;;AChJD,GAAG,WAAW,eAAe;"}