{"version":3,"file":"tourHistory.js","sources":["secondPages/tourHistory/tourHistory.vue","E:/HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c2Vjb25kUGFnZXNcdG91ckhpc3RvcnlcdG91ckhpc3RvcnkudnVl"],"sourcesContent":["<template>\r\n\t<view v-if=\"show\">\r\n\t\t<pageBack :titleInfo=\"titleInfo\"></pageBack>\r\n\t\t<view class=\"content\">\r\n\t\t\t<view v-if=\"postInfo.length >= 1\">\r\n\t\t\t\t<text class=\"clean\" @click=\"this.showDeleteConfirm = true;\">清空游览历史</text>\r\n\t\t\t\t<view class=\"postInfo\">\r\n\t\t\t\t\t<view class=\"postContent\">\r\n\t\t\t\t\t\t<view class=\"item\" v-for=\"(item,index) in postInfo\">\r\n\t\t\t\t\t\t\t<view class=\"itemContent\">\r\n\t\t\t\t\t\t\t\t<view class=\"header\">\r\n\t\t\t\t\t\t\t\t\t<image :src=\"item.avatarurl\" mode=\"\"></image>\r\n\t\t\t\t\t\t\t\t\t<view>{{item.nickname}}</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<view class=\"bottom\">\r\n\t\t\t\t\t\t\t\t\t<view class=\"info\">\r\n\t\t\t\t\t\t\t\t\t\t<view v-if=\"item.content.length < 100\" @click=\"showMore(item,index)\">\r\n\t\t\t\t\t\t\t\t\t\t\t<view v-html=\"item.content\"></view>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t<view v-else @click=\"showMore(item,index)\">\r\n\t\t\t\t\t\t\t\t\t\t\t<view v-if=\"!item.showMore\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view v-html=\"item.content.slice(0,50)\"></view>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<view style=\"text-align: right;\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text>......</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<text>双击展开</text>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t\t<view v-else v-html=\"item.content\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- {{item.content}} -->\r\n\t\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t<view class=\"container\">\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"list\" v-for=\"(imgItem, imgIndex) in item.imageUrl\"\r\n\t\t\t\t\t\t\t\t\t\t\tv-if=\"item.imageUrl.length > 1\">\r\n\t\t\t\t\t\t\t\t\t\t\t<image :src=\"imgItem\" mode=\"aspectFill\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t@click=\"previewImage(item.imageUrl, imgIndex)\">\r\n\t\t\t\t\t\t\t\t\t\t\t</image>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t\t<view class=\"list2\" v-for=\"(imgItem, imgIndex) in item.imageUrl\" v-else>\r\n\t\t\t\t\t\t\t\t\t\t\t<image :src=\"imgItem\" mode=\"aspectFill\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t@click=\"previewImage(item.imageUrl, imgIndex)\">\r\n\t\t\t\t\t\t\t\t\t\t\t</image>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"separate\"></view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"delete-confirm\" v-if=\"showDeleteConfirm\">\r\n\t\t\t\t\t<view class=\"delete-confirm-content\">\r\n\t\t\t\t\t\t<text>确定要清空游览历史吗?</text>\r\n\t\t\t\t\t\t<view class=\"delete-confirm-buttons\">\r\n\t\t\t\t\t\t\t<view class=\"delete-confirm-button\" @click=\"confirmDeleteHistory\">确定</view>\r\n\t\t\t\t\t\t\t<view class=\"delete-confirm-button\" @click=\"cancelDeleteHistory\">取消</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"noData\" v-else>\r\n\t\t\t\t<image src=\"../../static/history.svg\" mode=\"\"></image>\r\n\t\t\t\t<view class=\"\">\r\n\t\t\t\t\t您还没有游览记录哦~\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n<script>\r\n\timport pageBack from \"/components/title/title.vue\";\r\n\timport {\r\n\t\tuseUserInfoStore\r\n\t} from \"@/store/userInfo.js\"\r\n\timport {\r\n\t\tbyIdGetCommunityAPI\r\n\t} from \"/apis/community.js\"\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttitleInfo: {\r\n\t\t\t\t\ttitleShow: true,\r\n\t\t\t\t\ttitle: \"游览历史\",\r\n\t\t\t\t\timageUrl: \"http://t73sifiwt.hn-bkt.clouddn.com/pageBack/1.webp\",\r\n\t\t\t\t\theightShow: false,\r\n\t\t\t\t\tbackShow: true\r\n\t\t\t\t},\r\n\t\t\t\tpostInfo: [],\r\n\t\t\t\tshowDeleteConfirm: false,\r\n\t\t\t\tshow: false\r\n\t\t\t};\r\n\t\t},\r\n\t\tcomponents: {\r\n\t\t\tpageBack\r\n\t\t},\r\n\t\t// 在 created 钩子中读取本地存储的搜索历史\r\n\t\t// created() {\r\n\t\t// \t// 从本地存储中读取搜索历史  \r\n\t\t// \tthis.history = uni.getStorageSync('history').map(Number).toString() || []\r\n\t\t// },\r\n\t\tonLoad() {\r\n\t\t\t// this.getHistory(uni.getStorageSync('history').map(Number));\r\n\t\t\tconst historyIds = uni.getStorageSync('history');\r\n\t\t\tif (uni.getStorageSync('history')) {\r\n\t\t\t\tthis.getHistory(uni.getStorageSync('history').map(Number));\r\n\t\t\t} else {\r\n\t\t\t\tthis.show = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tgetHistory(ids) {\r\n\t\t\t\tbyIdGetCommunityAPI(ids).then((res) => {\r\n\t\t\t\t\tthis.postInfo = res.data.map((item) => {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t...item,\r\n\t\t\t\t\t\t\timageUrl: JSON.parse(item.imageUrl),\r\n\t\t\t\t\t\t\tshowMore: false\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.show = true\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tpreviewImage(urls, currentIndex) {\r\n\t\t\t\tuni.previewImage({\r\n\t\t\t\t\tcurrent: urls[currentIndex],\r\n\t\t\t\t\turls: urls\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tshowMore(item, index) {\r\n\t\t\t\tthis.touchNum++;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tif (this.touchNum === 1) {\r\n\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\turl: `/secondPages/communityDetail/communityDetail?postId=${item.id}`\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else if (this.touchNum >= 2) {\r\n\t\t\t\t\t\tthis.postInfo[index].showMore = !this.postInfo[index].showMore;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.touchNum = 0;\r\n\t\t\t\t}, 250);\r\n\t\t\t},\r\n\t\t\tconfirmDeleteHistory() {\r\n\t\t\t\t// 删除历史  \r\n\t\t\t\tuni.removeStorageSync('history'); // 清空本地存储的游览历史\r\n\t\t\t\tthis.postInfo = []; // 清空当前显示的历史游览记录\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '历史游览已清空',\r\n\t\t\t\t\ticon: 'success'\r\n\t\t\t\t});\r\n\t\t\t\tthis.showDeleteConfirm = false;\r\n\t\t\t},\r\n\t\t\tcancelDeleteHistory() {\r\n\t\t\t\tthis.showDeleteConfirm = false;\r\n\t\t\t},\r\n\t\t},\r\n\t\tonPageScroll(e) {\r\n\t\t\tif (e.scrollTop >= 80) {\r\n\t\t\t\tthis.titleInfo.heightShow = true;\r\n\t\t\t}\r\n\t\t\tif (e.scrollTop < 80) {\r\n\t\t\t\tthis.titleInfo.heightShow = false;\r\n\t\t\t}\r\n\t\t},\r\n\t}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\t.content {\r\n\t\tpadding-bottom: 200rpx;\r\n\t\tposition: relative;\r\n\t\ttop: 200rpx;\r\n\t\twidth: 100%;\r\n\t\tmin-height: 300rpx;\r\n\t\tbackground-color: rgb(255, 251, 241);\r\n\t\tborder-radius: 40rpx 40rpx 0 0;\r\n\t\toverflow: hidden;\r\n\t\tpadding: 20rpx 0;\r\n\t\tfont-family: \"阿里妈妈方圆体 VF Regular\" !important;\r\n\r\n\t\t.noData {\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: column;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: center;\r\n\t\t\tpadding: 200rpx 0;\r\n\r\n\t\t\tview {\r\n\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\tcolor: #4d0000;\r\n\t\t\t\t// padding: 50rpx 0;\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.clean {\r\n\t\t\tposition: absolute;\r\n\t\t\tright: 5%;\r\n\t\t\ttop: 40rpx;\r\n\t\t\tcolor: #4d0000;\r\n\t\t\tfont-weight: bold;\r\n\t\t}\r\n\r\n\t\t.postInfo {\r\n\t\t\t.postContent {\r\n\t\t\t\tpadding: 40rpx 0;\r\n\r\n\t\t\t\t.item {\r\n\t\t\t\t\tpadding: 20rpx 0;\r\n\r\n\t\t\t\t\t.itemContent {\r\n\t\t\t\t\t\twidth: 90%;\r\n\t\t\t\t\t\tmargin: auto;\r\n\r\n\t\t\t\t\t\t.header {\r\n\t\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\t\t\t\talign-items: center;\r\n\t\t\t\t\t\t\twidth: 100%;\r\n\r\n\t\t\t\t\t\t\timage {\r\n\t\t\t\t\t\t\t\twidth: 60rpx;\r\n\t\t\t\t\t\t\t\theight: 60rpx;\r\n\t\t\t\t\t\t\t\tborder-radius: 100%;\r\n\t\t\t\t\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t.info {\r\n\t\t\t\t\t\t\tpadding: 20rpx 0;\r\n\r\n\t\t\t\t\t\t\ttext {\r\n\t\t\t\t\t\t\t\tcolor: #888888;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t.container {\r\n\t\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t.list {\r\n\t\t\t\t\t\t\twidth: 32%;\r\n\t\t\t\t\t\t\taspect-ratio: 1;\r\n\r\n\t\t\t\t\t\t\timage {\r\n\t\t\t\t\t\t\t\t// width: 100%;\r\n\t\t\t\t\t\t\t\t// height: 100%;\r\n\t\t\t\t\t\t\t\twidth: 210rpx;\r\n\t\t\t\t\t\t\t\theight: 210rpx;\r\n\t\t\t\t\t\t\t\tborder-radius: 10rpx;\r\n\t\t\t\t\t\t\t\t// margin-top: 10rpx;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t.list:not(:nth-child(3n)) {\r\n\t\t\t\t\t\t\tmargin-right: calc(5% / 3);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t.list2 {\r\n\t\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t\t\taspect-ratio: 1;\r\n\r\n\t\t\t\t\t\t\timage {\r\n\t\t\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t\t\t\theight: 100%;\r\n\t\t\t\t\t\t\t\tborder-radius: 10rpx;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.separate {\r\n\t\t\t\t\t\tmargin: 40rpx 0 20rpx 0;\r\n\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t\theight: 20rpx;\r\n\t\t\t\t\t\tbackground-color: rgba(0, 0, 0, 0.04);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.delete-confirm {\r\n\t\t\tposition: fixed;\r\n\t\t\ttop: 0;\r\n\t\t\tleft: 0;\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 100%;\r\n\t\t\tbackground-color: rgba(0, 0, 0, 0.5);\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\t\t}\r\n\r\n\t\t.delete-confirm-content {\r\n\t\t\tbackground-color: #fff;\r\n\t\t\tpadding: 20px;\r\n\t\t\tborder-radius: 8px;\r\n\t\t\ttext-align: center;\r\n\t\t}\r\n\r\n\t\t.delete-confirm-buttons {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\tmargin-top: 20px;\r\n\t\t}\r\n\r\n\t\t.delete-confirm-button {\r\n\t\t\tpadding: 8px 16px;\r\n\t\t\tbackground-color: #4d0000;\r\n\t\t\tcolor: #fff;\r\n\t\t\tborder-radius: 4px;\r\n\t\t\tmargin: 0 8px;\r\n\t\t\tcursor: pointer;\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'D:/01前端学习/01fzhx/mazu-2/mazu-2/mazu-前端小程序/secondPages/tourHistory/tourHistory.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","byIdGetCommunityAPI"],"mappings":";;;;;;;EA+EE,OAAA;AACC,WAAA;AAAA;QAEE,WAAA;AAAA;QAEA,UAAA;AAAA,QACA,YAAA;AAAA;;;;MAKD,MAAA;AAAA;;;IAID;AAAA;;;;;;EAOD,SAAA;AAECA,kBAAA,MAAA,eAAA,SAAA;AACA,QAAAA,cAAA,MAAA,eAAA,SAAA,GAAA;;;AAGC,WAAA,OAAA;AAAA,IACD;AAAA;EAED,SAAA;AAAA,IACC,WAAA,KAAA;AACCC,qBAAAA,oBAAA,GAAA,EAAA,KAAA,CAAA,QAAA;AACC,aAAA,WAAA,IAAA,KAAA,IAAA,CAAA,SAAA;AACC,iBAAA;AAAA,YACC,GAAA;AAAA,YACA,UAAA,KAAA,MAAA,KAAA,QAAA;AAAA;UAED;AAAA;;MAGF,CAAA;AAAA;IAED,aAAA,MAAA,cAAA;AACCD,oBAAAA,MAAA,aAAA;AAAA;QAEC;AAAA,MACD,CAAA;AAAA;IAED,SAAA,MAAA,OAAA;AACC,WAAA;AACA,iBAAA,MAAA;AACC,YAAA,KAAA,aAAA,GAAA;AACCA,wBAAAA,MAAA,WAAA;AAAA,YACC,KAAA,uDAAA,KAAA,EAAA;AAAA,UACD,CAAA;AAAA;;QAGD;AACA,aAAA,WAAA;AAAA,MACD,GAAA,GAAA;AAAA;;AAIAA,0BAAA,kBAAA,SAAA;AACA,WAAA,WAAA;AACAA,oBAAAA,MAAA,UAAA;AAAA,QACC,OAAA;AAAA;MAED,CAAA;;;IAGD,sBAAA;;;;EAID,aAAA,GAAA;AACC,QAAA,EAAA,aAAA,IAAA;AACC,WAAA,UAAA,aAAA;AAAA,IACD;AACA,QAAA,EAAA,YAAA,IAAA;AACC,WAAA,UAAA,aAAA;AAAA,IACD;AAAA;AAEF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnKD,GAAG,WAAW,eAAe;"}