{"version":3,"file":"search.js","sources":["secondPages/search/search.vue","E:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c2Vjb25kUGFnZXNcc2VhcmNoXHNlYXJjaC52dWU"],"sourcesContent":["<template>\r\n\t<pageBack :titleInfo=\"titleInfo\"></pageBack>\r\n\t<view class=\"content\">\r\n\t\t<view class=\"header\">\r\n\t\t\t<view class=\"input\">\r\n\t\t\t\t<input type=\"search\" v-model=\"searchText\" @confirm=\"inputSearch\" />\r\n\t\t\t\t<image src=\"../../static/shop/search.png\" mode=\"\"></image>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"history\" v-if=\"!contentShow\">\r\n\t\t\t\t<view class=\"title\">\r\n\t\t\t\t\t<text>历史搜索</text>\r\n\t\t\t\t\t<text @click=\"delHistory\" v-if=\"searchHistory.length > 0\">删除</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"historyContent\">\r\n\t\t\t\t\t<view v-for=\"item in searchHistory.slice(0, 9)\" @click=\"postHistory(item)\">\r\n\t\t\t\t\t\t<text v-if=\"item.length > 5\">{{ item.slice(0, 5) }}...</text>\r\n\t\t\t\t\t\t<text v-else>{{ item }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<!-- 搜索出来的内容 -->\r\n\t\t\t<view class=\"postContent\" v-else>\r\n\t\t\t\t<view v-show=\"!judgeContent\" class=\"noData\">\r\n\t\t\t\t\t<image src=\"../../static/search.svg\" mode=\"\"></image>\r\n\t\t\t\t\t<view class=\"\">暂无匹配内容,请换个关键词~</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"item\" v-for=\"(item, index) in postInfo\">\r\n\t\t\t\t\t<view class=\"itemContent\">\r\n\t\t\t\t\t\t<view class=\"header\">\r\n\t\t\t\t\t\t\t<image :src=\"item.avatarurl\" mode=\"\"></image>\r\n\t\t\t\t\t\t\t<view>{{ item.nickname }}</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"bottom\">\r\n\t\t\t\t\t\t\t<view class=\"info\">\r\n\t\t\t\t\t\t\t\t<view v-if=\"item.content.length < 100\" @click=\"showMore(item, index)\">\r\n\t\t\t\t\t\t\t\t\t<view v-html=\"item.content\"></view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<view v-else @click=\"showMore(item, index)\">\r\n\t\t\t\t\t\t\t\t\t<view v-if=\"!item.showMore\">\r\n\t\t\t\t\t\t\t\t\t\t<view v-html=\"item.content.slice(0, 50)\"></view>\r\n\t\t\t\t\t\t\t\t\t\t<view style=\"text-align: right\">\r\n\t\t\t\t\t\t\t\t\t\t\t<text>......</text>\r\n\t\t\t\t\t\t\t\t\t\t\t<text>双击展开</text>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t<view v-else>\r\n\t\t\t\t\t\t\t\t\t\t{{item.content}}\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"container\">\r\n\t\t\t\t\t\t\t\t<view class=\"list\" v-for=\"(imgItem, imgIndex) in item.imageUrl\" v-if=\"item.imageUrl.length > 1\">\r\n\t\t\t\t\t\t\t\t\t<image :src=\"imgItem\" mode=\"aspectFill\" @click=\"previewImage(item.imageUrl, imgIndex)\"></image>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<view class=\"list2\" v-for=\"(imgItem, imgIndex) in item.imageUrl\" v-else>\r\n\t\t\t\t\t\t\t\t\t<image :src=\"imgItem\" mode=\"aspectFill\" @click=\"previewImage(item.imageUrl, imgIndex)\"></image>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"separate\"></view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"delete-confirm\" v-if=\"showDeleteConfirm\">\r\n\t\t\t<view class=\"delete-confirm-content\">\r\n\t\t\t\t<text>确定要删除所有搜索历史吗?</text>\r\n\t\t\t\t<view class=\"delete-confirm-buttons\">\r\n\t\t\t\t\t<view class=\"delete-confirm-button\" @click=\"confirmDeleteHistory\">确定</view>\r\n\t\t\t\t\t<view class=\"delete-confirm-button\" @click=\"cancelDeleteHistory\">取消</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport pageBack from '/components/title/title.vue';\r\nimport { searchCommunityAPI } from '../../apis/community.js';\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\ttitleInfo: {\r\n\t\t\t\ttitleShow: true,\r\n\t\t\t\ttitle: '搜索',\r\n\t\t\t\timageUrl: 'http://t73sifiwt.hn-bkt.clouddn.com/pageBack/1.webp',\r\n\t\t\t\theightShow: false,\r\n\t\t\t\tbackShow: true\r\n\t\t\t},\r\n\t\t\tsearchHistory: [],\r\n\t\t\tpostInfo: [],\r\n\t\t\tcontentShow: false,\r\n\t\t\tjudgeContent: false,\r\n\t\t\tsearchHistoryKey: 'searchHistory',\r\n\t\t\tsearchText: '',\r\n\t\t\tshowDeleteConfirm: false,\r\n\t\t\ttouchNum: 0\r\n\t\t};\r\n\t},\r\n\t// 在 created 钩子中读取本地存储的搜索历史\r\n\tcreated() {\r\n\t\t// 从本地存储中读取搜索历史\r\n\t\tthis.searchHistory = uni.getStorageSync(this.searchHistoryKey) || [];\r\n\t},\r\n\tcomponents: {\r\n\t\tpageBack\r\n\t},\r\n\tonPageScroll(e) {\r\n\t\tif (e.scrollTop >= 80) {\r\n\t\t\tthis.titleInfo.heightShow = true;\r\n\t\t}\r\n\t\tif (e.scrollTop < 80) {\r\n\t\t\tthis.titleInfo.heightShow = false;\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tinputSearch(e) {\r\n\t\t\tif (e.detail.value.trim() === '') {\r\n\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\ttitle: '内容不得为空',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t// 检查搜索内容是否已经存在于搜索历史中\r\n\t\t\tif (!this.searchHistory.includes(e.detail.value)) {\r\n\t\t\t\tthis.searchHistory.unshift(e.detail.value);\r\n\t\t\t\t// 保存搜索历史到本地存储\r\n\t\t\t\tuni.setStorageSync(this.searchHistoryKey, this.searchHistory);\r\n\t\t\t}\r\n\t\t\tthis.contentShow = true;\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '搜索中'\r\n\t\t\t});\r\n\t\t\tsearchCommunityAPI({\r\n\t\t\t\tcontent: e.detail.value\r\n\t\t\t})\r\n\t\t\t\t.then((res) => {\r\n\t\t\t\t\tif (res.message.length > 0) {\r\n\t\t\t\t\t\tthis.judgeContent = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.postInfo = res.message.map((item) => {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t...item,\r\n\t\t\t\t\t\t\timageUrl: JSON.parse(item.imageUrl)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\t.finally(() => {\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t});\r\n\t\t},\r\n\t\tpostHistory(item) {\r\n\t\t\tthis.searchText = item;\r\n\t\t\tthis.inputSearch({\r\n\t\t\t\tdetail: {\r\n\t\t\t\t\tvalue: item\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tdelHistory() {\r\n\t\t\tthis.showDeleteConfirm = true;\r\n\t\t},\r\n\t\tconfirmDeleteHistory() {\r\n\t\t\t// 删除搜索历史\r\n\t\t\tthis.searchHistory = [];\r\n\t\t\tuni.setStorageSync(this.searchHistoryKey, this.searchHistory);\r\n\t\t\tthis.showDeleteConfirm = false;\r\n\t\t},\r\n\t\tcancelDeleteHistory() {\r\n\t\t\tthis.showDeleteConfirm = false;\r\n\t\t},\r\n\t\t// 点击图片放大\r\n\t\tpreviewImage(urls, currentIndex) {\r\n\t\t\tuni.previewImage({\r\n\t\t\t\tcurrent: urls[currentIndex],\r\n\t\t\t\turls: urls\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 展开/进入\r\n\t\tshowMore(item, index) {\r\n\t\t\tthis.touchNum++;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (this.touchNum === 1) {\r\n\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\turl: `/secondPages/communityDetail/communityDetail?postId=${item.id}`\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (this.touchNum >= 2) {\r\n\t\t\t\t\tthis.postInfo[index].showMore = !this.postInfo[index].showMore;\r\n\t\t\t\t}\r\n\t\t\t\tthis.touchNum = 0;\r\n\t\t\t}, 250);\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.content {\r\n\tpadding-bottom: 200rpx;\r\n\tposition: relative;\r\n\ttop: 200rpx;\r\n\twidth: 100%;\r\n\tmin-height: 300rpx;\r\n\tbackground-color: rgb(255, 251, 241);\r\n\tborder-radius: 40rpx 40rpx 0 0;\r\n\toverflow: hidden;\r\n\tpadding: 40rpx 0;\r\n\tfont-family: '阿里妈妈方圆体 VF Regular' !important;\r\n\r\n\t.noData {\r\n\t\ttext-align: center;\r\n\t\tcolor: #4d0000;\r\n\t}\r\n\r\n\t.header {\r\n\t\t.input {\r\n\t\t\tfont-family: '阿里妈妈方圆体 VF Regular';\r\n\t\t\twidth: 90%;\r\n\t\t\tmargin: auto;\r\n\t\t\theight: 80rpx;\r\n\t\t\tbackground-color: #fffbf2;\r\n\t\t\tborder-radius: 40rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tposition: relative;\r\n\t\t\tbackground-color: #fff;\r\n\t\t\tbox-shadow: rgba(0, 0, 0, 0.05) 0px 0px 0px 1px;\r\n\r\n\t\t\tinput {\r\n\t\t\t\tpadding-left: 100rpx;\r\n\t\t\t\twidth: 80%;\r\n\t\t\t\tcolor: #4d0000;\r\n\t\t\t}\r\n\r\n\t\t\timage {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\twidth: 52rpx;\r\n\t\t\t\theight: 52rpx;\r\n\t\t\t\tleft: 4%;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.history {\r\n\t\t\tpadding: 20rpx;\r\n\r\n\t\t\t.title {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: space-between;\r\n\t\t\t\talign-items: center;\r\n\t\t\t}\r\n\r\n\t\t\t.historyContent {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tpadding: 20rpx 0;\r\n\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\tmargin-top: -20rpx;\r\n\r\n\t\t\t\tview {\r\n\t\t\t\t\tmargin-top: 20rpx;\r\n\t\t\t\t\tfont-size: 26rpx;\r\n\t\t\t\t\tpadding: 10rpx 20rpx;\r\n\t\t\t\t\tbackground-color: rgba(0, 0, 0, 0.05);\r\n\t\t\t\t\t// color: #000;\r\n\t\t\t\t\tborder-radius: 10rpx;\r\n\t\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.postContent {\r\n\t\t\tpadding: 40rpx 0;\r\n\r\n\t\t\t.item {\r\n\t\t\t\tpadding: 20rpx 0;\r\n\r\n\t\t\t\t.itemContent {\r\n\t\t\t\t\twidth: 90%;\r\n\t\t\t\t\tmargin: auto;\r\n\r\n\t\t\t\t\t.header {\r\n\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\t\t\talign-items: center;\r\n\t\t\t\t\t\twidth: 100%;\r\n\r\n\t\t\t\t\t\timage {\r\n\t\t\t\t\t\t\twidth: 60rpx;\r\n\t\t\t\t\t\t\theight: 60rpx;\r\n\t\t\t\t\t\t\tborder-radius: 100%;\r\n\t\t\t\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.info {\r\n\t\t\t\t\t\tpadding: 20rpx 0;\r\n\r\n\t\t\t\t\t\ttext {\r\n\t\t\t\t\t\t\tcolor: #888888;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.container {\r\n\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.list {\r\n\t\t\t\t\t\twidth: 32%;\r\n\t\t\t\t\t\taspect-ratio: 1;\r\n\r\n\t\t\t\t\t\timage {\r\n\t\t\t\t\t\t\t// width: 100%;\r\n\t\t\t\t\t\t\t// height: 100%;\r\n\t\t\t\t\t\t\twidth: 210rpx;\r\n\t\t\t\t\t\t\theight: 210rpx;\r\n\t\t\t\t\t\t\tborder-radius: 10rpx;\r\n\t\t\t\t\t\t\t// margin-top: 10rpx;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.list:not(:nth-child(3n)) {\r\n\t\t\t\t\t\tmargin-right: calc(5% / 3);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.list2 {\r\n\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t\taspect-ratio: 1;\r\n\r\n\t\t\t\t\t\timage {\r\n\t\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t\t\theight: 100%;\r\n\t\t\t\t\t\t\tborder-radius: 10rpx;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.separate {\r\n\t\t\t\t\tmargin: 40rpx 0 20rpx 0;\r\n\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\theight: 20rpx;\r\n\t\t\t\t\tbackground-color: rgba(0, 0, 0, 0.04);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n.delete-confirm {\r\n\tposition: fixed;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tbackground-color: rgba(0, 0, 0, 0.5);\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n\talign-items: center;\r\n}\r\n\r\n.delete-confirm-content {\r\n\tbackground-color: #fff;\r\n\tpadding: 20px;\r\n\tborder-radius: 8px;\r\n\ttext-align: center;\r\n}\r\n\r\n.delete-confirm-buttons {\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n\tmargin-top: 20px;\r\n}\r\n\r\n.delete-confirm-button {\r\n\tpadding: 8px 16px;\r\n\tbackground-color: #4d0000;\r\n\tcolor: #fff;\r\n\tborder-radius: 4px;\r\n\tmargin: 0 8px;\r\n\tcursor: pointer;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'C:/Users/18706/Desktop/MZ/mazu-前端小程序/secondPages/search/search.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","searchCommunityAPI"],"mappings":";;;;AA6EA,MAAA,WAAA,MAAA;AAEA,MAAA,YAAA;AAAA,EACC,OAAA;AACC,WAAA;AAAA;QAEE,WAAA;AAAA;QAEA,UAAA;AAAA,QACA,YAAA;AAAA;;MAGD,eAAA,CAAA;AAAA;MAEA,aAAA;AAAA,MACA,cAAA;AAAA,MACA,kBAAA;AAAA;;MAGA,UAAA;AAAA;;;EAIF,UAAA;AAEC,SAAA,gBAAAA,oBAAA,eAAA,KAAA,gBAAA,KAAA;;;IAGA;AAAA;EAED,aAAA,GAAA;AACC,QAAA,EAAA,aAAA,IAAA;AACC,WAAA,UAAA,aAAA;AAAA,IACD;AACA,QAAA,EAAA,YAAA,IAAA;AACC,WAAA,UAAA,aAAA;AAAA,IACD;AAAA;EAED,SAAA;AAAA,IACC,YAAA,GAAA;AACC,UAAA,EAAA,OAAA,MAAA,KAAA,MAAA,IAAA;AACC,eAAAA,cAAAA,MAAA,UAAA;AAAA,UACC,OAAA;AAAA;QAED,CAAA;AAAA,MACD;;AAGC,aAAA,cAAA,QAAA,EAAA,OAAA,KAAA;;MAGD;AACA,WAAA,cAAA;AACAA,oBAAAA,MAAA,YAAA;AAAA;MAEA,CAAA;AACAC,wCAAA;AAAA,QACC,SAAA,EAAA,OAAA;AAAA;;;QAKC;AACA,aAAA,WAAA,IAAA,QAAA,IAAA,CAAA,SAAA;AACC,iBAAA;AAAA,YACC,GAAA;AAAA,YACA,UAAA,KAAA,MAAA,KAAA,QAAA;AAAA;QAEF,CAAA;AAAA;AAGAD,sBAAA,MAAA,YAAA;AAAA,MACD,CAAA;AAAA;IAEF,YAAA,MAAA;AACC,WAAA,aAAA;AACA,WAAA,YAAA;AAAA,QACC,QAAA;AAAA,UACC,OAAA;AAAA,QACD;AAAA,MACD,CAAA;AAAA;;;;;AAOA,WAAA,gBAAA;;;;IAID,sBAAA;;;;IAIA,aAAA,MAAA,cAAA;AACCA,oBAAAA,MAAA,aAAA;AAAA;QAEC;AAAA,MACD,CAAA;AAAA;;IAGD,SAAA,MAAA,OAAA;AACC,WAAA;AACA,iBAAA,MAAA;AACC,YAAA,KAAA,aAAA,GAAA;AACCA,wBAAAA,MAAA,WAAA;AAAA,YACC,KAAA,uDAAA,KAAA,EAAA;AAAA,UACD,CAAA;AAAA;;QAGD;AACA,aAAA,WAAA;AAAA,MACD,GAAA,GAAA;AAAA,IACD;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChMA,GAAG,WAAW,eAAe;"}