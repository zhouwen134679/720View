{"version":3,"file":"incense.js","sources":["secondPages/incense/incense.vue","E:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c2Vjb25kUGFnZXNcaW5jZW5zZVxpbmNlbnNlLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<pageBack :titleInfo=\"titleInfo\"></pageBack>\r\n\t<view class=\"content\">\r\n\t\t<view class=\"container\">\r\n\t\t\t<view class=\"shopName\">\r\n\t\t\t\t<view class=\"shopTitle\">公益项目</view>\r\n\t\t\t\t<view class=\"shopEngTitle\">Public Welfare Projects</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"input\">\r\n\t\t\t\t<input type=\"text\" v-model=\"searchText\" placeholder=\"搜索公益项目\" @input=\"searchProjects\" />\r\n\t\t\t\t<image src=\"../../static/shop/search.png\" mode=\"\"></image>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"shop\">\r\n\t\t\t\t<view class=\"pubuBox\">\r\n\t\t\t\t\t<view class=\"pubuItem\">\r\n\t\t\t\t\t\t<!-- v-for列表循环 -->\r\n\t\t\t\t\t\t<view class=\"item-masonry\" v-for=\"(item, index) in list\" :key=\"index\" @click=\"toShowDetail(item.id)\">\r\n\t\t\t\t\t\t\t<image :lazy-load=\"true\" :src=\"item.imageUrl[0]\" mode=\"aspectFill\"></image>\r\n\t\t\t\t\t\t\t<view class=\"listtitle\">\r\n\t\t\t\t\t\t\t\t<!-- 这是没有高度的父盒子（下半部分） -->\r\n\t\t\t\t\t\t\t\t<view class=\"listtitle2\">\r\n\t\t\t\t\t\t\t\t\t{{ item.shopname }}\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<view class=\"listtitle3\">\r\n\t\t\t\t\t\t\t\t\t<text>捐款金额</text>\r\n\t\t\t\t\t\t\t\t\t{{ formatPrice(item.price) }}\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport pageBack from '/components/title/title.vue';\r\nimport { getShopListAPI, gridSearchShopAPI } from '/apis/shop.js';\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\ttitleInfo: {\r\n\t\t\t\ttitleShow: true,\r\n\t\t\t\ttitle: '公益项目',\r\n\t\t\t\timageUrl: 'http://t73sifiwt.hn-bkt.clouddn.com/pageBack/3.webp',\r\n\t\t\t\theightShow: false,\r\n\t\t\t\tbackShow: true\r\n\t\t\t},\r\n\t\t\tlist: [],\r\n\t\t\tsearchText: ''\r\n\t\t};\r\n\t},\r\n\tcomponents: {\r\n\t\tpageBack\r\n\t},\r\n\tonLoad() {\r\n\t\tthis.getPublicProjects();\r\n\t},\r\n\tmethods: {\r\n\t\t// ========== 新增：价格格式化方法 ==========\r\n\t\tformatPrice(price) {\r\n\t\t\t// 完整的容错处理，避免 toFixed 报错\r\n\t\t\tconst num = Number(price);\r\n\t\t\t// 如果转换失败（非数字），返回 0.00\r\n\t\t\treturn isNaN(num) ? '0.00' : num.toFixed(2);\r\n\t\t},\r\n\t\t// 获取公益项目列表\r\n\t\tgetPublicProjects() {\r\n\t\t\t// 使用gridSearchShopAPI查询公益分类下的商品\r\n\t\t\tgridSearchShopAPI('公益')\r\n\t\t\t\t.then((res) => {\r\n\t\t\t\t\t// 容错：判断 res.message 是否存在\r\n\t\t\t\t\tif (res && res.message) {\r\n\t\t\t\t\t\tthis.list = res.message.map((item) => {\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t...item,\r\n\t\t\t\t\t\t\t\timageUrl: JSON.parse(item.imageUrl || '[]') // 容错：imageUrl 为空时解析为空数组\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.list = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.catch((err) => {\r\n\t\t\t\t\tconsole.error('获取公益项目失败：', err);\r\n\t\t\t\t\tthis.list = [];\r\n\t\t\t\t});\r\n\t\t},\r\n\t\t// 搜索公益项目\r\n\t\tsearchProjects() {\r\n\t\t\tif (!this.searchText) {\r\n\t\t\t\tthis.getPublicProjects();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// 简单的本地搜索，根据商品名称过滤\r\n\t\t\tconst filteredList = this.list.filter(item => \r\n\t\t\t\titem.shopname.toLowerCase().includes(this.searchText.toLowerCase())\r\n\t\t\t);\r\n\t\t\tthis.list = filteredList;\r\n\t\t},\r\n\t\t// 跳转到商品详情页\r\n\t\ttoShowDetail(id) {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: `/secondPages/shopDetail/shopDetail?shopId=${id}`\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\t.content {\r\n\t\tpadding-bottom: 200rpx;\r\n\t\tposition: relative;\r\n\t\ttop: 200rpx;\r\n\t\twidth: 100%;\r\n\t\tmin-height: 300rpx;\r\n\t\tbackground-color: rgb(255, 251, 241);\r\n\t\tborder-radius: 40rpx 40rpx 0 0;\r\n\t\toverflow: hidden;\r\n\r\n\t\t// 瀑布流\r\n\t\t.shop {\r\n\t\t\twidth: 95%;\r\n\t\t\tmargin: auto;\r\n\t\t\tfont-family: '阿里妈妈方圆体 VF Regular';\r\n\r\n\t\t\t.pubuItem {\r\n\t\t\t\tcolumn-count: 2;\r\n\t\t\t\tcolumn-gap: 20rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.item-masonry {\r\n\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\tborder-radius: 15rpx;\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t\tbackground-color: #fff;\r\n\t\t\t\tbreak-inside: avoid;\r\n\t\t\t\t/*避免在元素内部插入分页符*/\r\n\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\tmargin-bottom: 20rpx;\r\n\t\t\t\tbox-shadow: 0px 0px 28rpx 1rpx rgba(78, 101, 153, 0.07);\r\n\t\t\t}\r\n\r\n\t\t\t.item-masonry image {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t}\r\n\r\n\t\t\t.listtitle {\r\n\t\t\t\tpadding: 22rpx;\r\n\t\t\t\tpadding-top: 10rpx;\r\n\t\t\t\tfont-size: 28rpx;\r\n\r\n\t\t\t\t.listtitle1 {\r\n\t\t\t\t\tline-height: 39rpx;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.listtitle3 {\r\n\t\t\t\t\tfont-size: 40rpx;\r\n\t\t\t\t\tline-height: 32rpx;\r\n\t\t\t\t\tcolor: rgb(170, 0, 0);\r\n\t\t\t\t\tpadding-top: 22rpx;\r\n\r\n\t\t\t\t\ttext {\r\n\t\t\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.shopName {\r\n\t\tfont-family: '阿里妈妈方圆体 VF Regular';\r\n\t\t// font-weight: 600;\r\n\t\tpadding: 40rpx 20rpx;\r\n\t\tcolor: #4d0000;\r\n\r\n\t\t.shopTitle {\r\n\t\t\tfont-size: 60rpx;\r\n\t\t\tfont-weight: bold;\r\n\t\t}\r\n\r\n\t\t.shopEngTitle {\r\n\t\t\tmargin-top: 5rpx;\r\n\t\t\tfont-size: 26rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t.input {\r\n\t\tfont-family: '阿里妈妈方圆体 VF Regular';\r\n\t\twidth: 95%;\r\n\t\theight: 80rpx;\r\n\t\tbackground-color: #fffbf2;\r\n\t\tmargin: auto;\r\n\t\tborder-radius: 20rpx;\r\n\t\tmargin-bottom: 30rpx;\r\n\t\t// margin-top: -20rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tposition: relative;\r\n\t\tbackground-color: #fff;\r\n\t\tbox-shadow: rgba(0, 0, 0, 0.05) 0px 0px 0px 1px;\r\n\r\n\t\tinput {\r\n\t\t\tpadding-left: 100rpx;\r\n\t\t\twidth: 80%;\r\n\t\t\tcolor: #4d0000;\r\n\t\t}\r\n\r\n\t\timage {\r\n\t\t\tposition: absolute;\r\n\t\t\twidth: 52rpx;\r\n\t\t\theight: 52rpx;\r\n\t\t\tleft: 4%;\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'C:/Users/18706/Desktop/MZ/mazu-前端小程序/secondPages/incense/incense.vue'\nwx.createPage(MiniProgramPage)"],"names":["gridSearchShopAPI","uni"],"mappings":";;;;AAqCA,iBAAiB,MAAW;AAE5B,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,WAAW;AAAA,QACV,WAAW;AAAA,QACX,OAAO;AAAA,QACP,UAAU;AAAA,QACV,YAAY;AAAA,QACZ,UAAU;AAAA,MACV;AAAA,MACD,MAAM,CAAE;AAAA,MACR,YAAY;AAAA;EAEb;AAAA,EACD,YAAY;AAAA,IACX;AAAA,EACA;AAAA,EACD,SAAS;AACR,SAAK,kBAAiB;AAAA,EACtB;AAAA,EACD,SAAS;AAAA;AAAA,IAER,YAAY,OAAO;AAElB,YAAM,MAAM,OAAO,KAAK;AAExB,aAAO,MAAM,GAAG,IAAI,SAAS,IAAI,QAAQ,CAAC;AAAA,IAC1C;AAAA;AAAA,IAED,oBAAoB;AAEnBA,gBAAAA,kBAAkB,IAAI,EACpB,KAAK,CAAC,QAAQ;AAEd,YAAI,OAAO,IAAI,SAAS;AACvB,eAAK,OAAO,IAAI,QAAQ,IAAI,CAAC,SAAS;AACrC,mBAAO;AAAA,cACN,GAAG;AAAA,cACH,UAAU,KAAK,MAAM,KAAK,YAAY,IAAI;AAAA;AAAA,YAC3C;AAAA,UACD,CAAC;AAAA,eACK;AACN,eAAK,OAAO;QACb;AAAA,OACA,EACA,MAAM,CAAC,QAAQ;AACfC,oFAAc,aAAa,GAAG;AAC9B,aAAK,OAAO;MACb,CAAC;AAAA,IACF;AAAA;AAAA,IAED,iBAAiB;AAChB,UAAI,CAAC,KAAK,YAAY;AACrB,aAAK,kBAAiB;AACtB;AAAA,MACD;AAEA,YAAM,eAAe,KAAK,KAAK;AAAA,QAAO,UACrC,KAAK,SAAS,YAAa,EAAC,SAAS,KAAK,WAAW,aAAa;AAAA;AAEnE,WAAK,OAAO;AAAA,IACZ;AAAA;AAAA,IAED,aAAa,IAAI;AAChBA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,6CAA6C,EAAE;AAAA,MACrD,CAAC;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;AC3GA,GAAG,WAAW,eAAe;"}