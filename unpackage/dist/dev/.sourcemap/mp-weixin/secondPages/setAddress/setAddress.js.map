{"version":3,"file":"setAddress.js","sources":["secondPages/setAddress/setAddress.vue","E:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c2Vjb25kUGFnZXNcc2V0QWRkcmVzc1xzZXRBZGRyZXNzLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view v-if=\"addList\">\r\n\t\t<pageBack :titleInfo=\"titleInfo\"></pageBack>\r\n\t\t<view class=\"content\">\r\n\t\t\t<view class=\"address\">\r\n\t\t\t\t<view class=\"item\" v-for=\"item in addList\">\r\n\t\t\t\t\t<view class=\"one\" @click=\"chooseItem(item)\">\r\n\t\t\t\t\t\t<text>{{item.name}}</text>\r\n\t\t\t\t\t\t<text>{{item.mobile}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"two\" @click=\"chooseItem(item)\">\r\n\t\t\t\t\t\t<view>\r\n\t\t\t\t\t\t\t<text>{{item.province_id}}</text>\r\n\t\t\t\t\t\t\t<text>{{item.city_id}}</text>\r\n\t\t\t\t\t\t\t<text>{{item.district_id}}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view>\r\n\t\t\t\t\t\t\t<text>{{item.remark}}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"edit\">\r\n\t\t\t\t\t\t<view class=\"default\">\r\n\t\t\t\t\t\t\t<switch :checked=\"item.isDefault\" @change=\"handleSwitchChange(item)\" />\r\n\t\t\t\t\t\t\t<text>设置为默认地址</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"label\">\r\n\t\t\t\t\t\t\t<view class=\"\" @click=\"toAdd(2,item.id)\">\r\n\t\t\t\t\t\t\t\t修改\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"\" @click=\"del(item.id,item.user_id)\">\r\n\t\t\t\t\t\t\t\t删除\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"addAddress\">\r\n\t\t\t\t<view class=\"addButton\" @click=\"toAdd(1)\">\r\n\t\t\t\t\t新增收货地址\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"delete-confirm\" v-if=\"showDeleteConfirm\">\r\n\t\t\t<view class=\"delete-confirm-content\">\r\n\t\t\t\t<text>确定要删除该条收货地址</text>\r\n\t\t\t\t<view class=\"delete-confirm-buttons\">\r\n\t\t\t\t\t<view class=\"delete-confirm-button\" @click=\"confirmDeleteHistory\">确定</view>\r\n\t\t\t\t\t<view class=\"delete-confirm-button\" @click=\"cancelDeleteHistory\">取消</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport pageBack from \"/components/title/title.vue\";\r\n\timport {\r\n\t\tgetAddressAPI,\r\n\t\teditAddressAPI,\r\n\t\tdelAddressAPI\r\n\t} from \"../../apis/shop.js\"\r\n\timport {\r\n\t\tuseUserInfoStore\r\n\t} from \"/store/userInfo.js\"\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttitleInfo: {\r\n\t\t\t\t\ttitleShow: true,\r\n\t\t\t\t\ttitle: \"收货地址\",\r\n\t\t\t\t\timageUrl: \"http://t73sifiwt.hn-bkt.clouddn.com/pageBack/1.webp\",\r\n\t\t\t\t\theightShow: false,\r\n\t\t\t\t\tbackShow: true\r\n\t\t\t\t},\r\n\t\t\t\taddList: [],\r\n\t\t\t\tisDefault: false,\r\n\t\t\t\tshowDeleteConfirm: false,\r\n\t\t\t\tdelId: null,\r\n\t\t\t\tdelUserId: null\r\n\t\t\t};\r\n\t\t},\r\n\t\tcomponents: {\r\n\t\t\tpageBack\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\tthis.getAddress()\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\ttoAdd(code, id) {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: `/secondPages/addAddress/addAddress?pageCode=${code}&addressId=${id}`\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tchooseItem(item) {\r\n\t\t\t\tuni.$emit('addressData', item)\r\n\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\tdelta: 1\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tgetAddress() {\r\n\t\t\t\tgetAddressAPI(useUserInfoStore().$state.userInfo.id).then((res) => {\r\n\t\t\t\t\tthis.addList = res.message\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\thandleSwitchChange(item) {\r\n\t\t\t\tconst newIsDefault = !item.isDefault; // 切换当前开关状态\r\n\t\t\t\t// 如果新的 isDefault 为 true，则更新其他地址的 isDefault 为 false\r\n\t\t\t\tif (newIsDefault) {\r\n\t\t\t\t\t// 更新其他地址为非默认\r\n\t\t\t\t\tthis.addList.forEach(address => {\r\n\t\t\t\t\t\tif (address.id !== item.id) {\r\n\t\t\t\t\t\t\taddress.isDefault = false; // 将其他地址的 isDefault 设置为 false\r\n\t\t\t\t\t\t\t// 这里可以调用 API 更新其他地址的状态\r\n\t\t\t\t\t\t\teditAddressAPI({\r\n\t\t\t\t\t\t\t\tid: address.id,\r\n\t\t\t\t\t\t\t\tuser_id: address.user_id,\r\n\t\t\t\t\t\t\t\tprovince: address.province_id,\r\n\t\t\t\t\t\t\t\tcity: address.city_id,\r\n\t\t\t\t\t\t\t\tdistrict: address.district_id,\r\n\t\t\t\t\t\t\t\tremark: address.remark,\r\n\t\t\t\t\t\t\t\tname: address.name,\r\n\t\t\t\t\t\t\t\tmobile: address.mobile,\r\n\t\t\t\t\t\t\t\tisDefault: false // 将其他地址设置为非默认\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 更新当前地址的 isDefault\r\n\t\t\t\teditAddressAPI({\r\n\t\t\t\t\tid: item.id,\r\n\t\t\t\t\tuser_id: item.user_id,\r\n\t\t\t\t\tprovince: item.province_id,\r\n\t\t\t\t\tcity: item.city_id,\r\n\t\t\t\t\tdistrict: item.district_id,\r\n\t\t\t\t\tremark: item.remark,\r\n\t\t\t\t\tname: item.name,\r\n\t\t\t\t\tmobile: item.mobile,\r\n\t\t\t\t\tisDefault: newIsDefault // 传递新的 isDefault 值\r\n\t\t\t\t}).then((res) => {\r\n\t\t\t\t\tconsole.log('地址修改成功:', res);\r\n\t\t\t\t\tuni.$emit('addressData', item)\r\n\t\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\t\tdelta: 1\r\n\t\t\t\t\t})\r\n\t\t\t\t\t// 更新本地状态\r\n\t\t\t\t\titem.isDefault = newIsDefault; // 更新当前地址的状态\r\n\t\t\t\t}).catch((error) => {\r\n\t\t\t\t\tconsole.error('地址修改失败:', error);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tdel(id, userId) {\r\n\t\t\t\tthis.showDeleteConfirm = true\r\n\t\t\t\tthis.delId = id\r\n\t\t\t\tthis.delUserId = userId\r\n\t\t\t},\r\n\t\t\tconfirmDeleteHistory() {\r\n\t\t\t\t// 删除  \r\n\t\t\t\tthis.showDeleteConfirm = false;\r\n\t\t\t\tdelAddressAPI({\r\n\t\t\t\t\tid: this.delId,\r\n\t\t\t\t\tuser_id: this.delUserId\r\n\t\t\t\t}).then((res) => {\r\n\t\t\t\t\tif (res.status == 200) {\r\n\t\t\t\t\t\tthis.getAddress()\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: \"删除成功\"\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: \"删除失败\" + res.message,\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tcancelDeleteHistory() {\r\n\t\t\t\tthis.showDeleteConfirm = false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\t.content {\r\n\t\tpadding-bottom: 200rpx;\r\n\t\tposition: relative;\r\n\t\ttop: 200rpx;\r\n\t\twidth: 100%;\r\n\t\tmin-height: 300rpx;\r\n\t\tbackground-color: rgb(255, 251, 241);\r\n\t\tborder-radius: 40rpx 40rpx 0 0;\r\n\t\toverflow: hidden;\r\n\t\tpadding: 20rpx 0;\r\n\t\tfont-family: \"阿里妈妈方圆体 VF Regular\" !important;\r\n\r\n\t\t.address {\r\n\t\t\twidth: 100%;\r\n\t\t\t// display: flex;\r\n\t\t\t// justify-content: space-between;\r\n\t\t\t// align-items: center;\r\n\t\t\tposition: relative;\r\n\t\t\tpadding-bottom: 20rpx;\r\n\r\n\t\t\t.item {\r\n\t\t\t\tmargin: auto;\r\n\t\t\t\twidth: 90%;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\t// height: 200rpx;\r\n\t\t\t\tpadding: 20rpx 0;\r\n\t\t\t\tborder-bottom: 2rpx solid rgba(0, 0, 0, 0.05);\r\n\r\n\t\t\t\t.one {\r\n\t\t\t\t\tfont-size: 38rpx;\r\n\t\t\t\t\tpadding: 10rpx 0;\r\n\r\n\t\t\t\t\ttext {\r\n\t\t\t\t\t\tpadding-right: 20rpx;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.two {\r\n\t\t\t\t\tfont-size: 24rpx;\r\n\r\n\t\t\t\t\ttext {\r\n\t\t\t\t\t\tpadding-right: 10rpx;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.edit {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\tjustify-content: space-between;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tfont-size: 28rpx;\r\n\r\n\t\t\t\t\t.default {\r\n\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\talign-items: center;\r\n\r\n\t\t\t\t\t\tswitch {\r\n\t\t\t\t\t\t\ttransform: scale(0.6);\r\n\t\t\t\t\t\t\tmargin-left: -6%;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.label {\r\n\t\t\t\t\t\tdisplay: flex;\r\n\r\n\t\t\t\t\t\tview {\r\n\t\t\t\t\t\t\tpadding: 10rpx 15rpx;\r\n\t\t\t\t\t\t\tmargin-left: 10rpx;\r\n\t\t\t\t\t\t\tborder-radius: 10rpx;\r\n\t\t\t\t\t\t\tcolor: #fff;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tview:first-child {\r\n\t\t\t\t\t\t\tbackground-color: seagreen;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tview:last-child {\r\n\t\t\t\t\t\t\tbackground-color: rgb(170, 0, 0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.addAddress {\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 160rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\r\n\t\t\t.addButton {\r\n\t\t\t\twidth: 400rpx;\r\n\t\t\t\theight: 80rpx;\r\n\t\t\t\tbackground-color: #4d0000;\r\n\t\t\t\tcolor: #fff;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tborder-radius: 20rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.delete-confirm {\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tbackground-color: rgba(0, 0, 0, 0.5);\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.delete-confirm-content {\r\n\t\tbackground-color: #fff;\r\n\t\tpadding: 20px;\r\n\t\tborder-radius: 8px;\r\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t.delete-confirm-buttons {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\tmargin-top: 20px;\r\n\t}\r\n\r\n\t.delete-confirm-button {\r\n\t\tpadding: 8px 16px;\r\n\t\tbackground-color: #4d0000;\r\n\t\tcolor: #fff;\r\n\t\tborder-radius: 4px;\r\n\t\tmargin: 0 8px;\r\n\t\tcursor: pointer;\r\n\t}\r\n</style>","import MiniProgramPage from 'C:/Users/18706/Desktop/MZ/mazu-前端小程序/secondPages/setAddress/setAddress.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","getAddressAPI","useUserInfoStore","editAddressAPI","delAddressAPI"],"mappings":"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"}