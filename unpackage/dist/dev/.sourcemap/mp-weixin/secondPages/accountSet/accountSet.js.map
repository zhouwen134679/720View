{"version":3,"file":"accountSet.js","sources":["secondPages/accountSet/accountSet.vue","E:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c2Vjb25kUGFnZXNcYWNjb3VudFNldFxhY2NvdW50U2V0LnZ1ZQ"],"sourcesContent":["<template>\r\n\t<pageBack :titleInfo=\"titleInfo\"></pageBack>\r\n\t<view class=\"content\">\r\n\t\t<view class=\"info\">\r\n\t\t\t<view class=\"infoHeader\">\r\n\t\t\t\t<button class=\"avatar-wrapper\" open-type=\"chooseAvatar\" bind:chooseavatar=\"onChooseAvatar\">\r\n\t\t\t\t\t<image class=\"avatar\" :src=\"userInfo.avatarurl\" mode=\"aspectFill\"></image>\r\n\t\t\t\t</button>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"user\">\r\n\t\t\t\t<view class=\"name\">\r\n\t\t\t\t\t<input type=\"nickname\" @blur=\"updateNickname\" :value=\"userInfo.nickname\" class=\"weui-input\"\r\n\t\t\t\t\t\tplaceholder=\"请输入昵称\" />\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n\t<view class=\"loginOut\" @click=\"loginOut()\">\r\n\t\t退出登录\r\n\t</view>\r\n</template>\r\n<script>\r\n\timport pageBack from \"/components/title/title.vue\";\r\n\timport {\r\n\t\tuseUserInfoStore\r\n\t} from \"@/store/userInfo.js\"\r\n\timport {\r\n\t\teditNicknameAPI,\r\n\t\teditUserHeaders\r\n\t} from \"@/apis/user\"\r\n\timport {\r\n\t\tbase_url\r\n\t} from \"@/utils/request.js\"\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttitleInfo: {\r\n\t\t\t\t\ttitleShow: true,\r\n\t\t\t\t\ttitle: \"账户设置\",\r\n\t\t\t\t\timageUrl: \"http://t73sifiwt.hn-bkt.clouddn.com/pageBack/1.webp\",\r\n\t\t\t\t\theightShow: false,\r\n\t\t\t\t\tbackShow: true\r\n\t\t\t\t},\r\n\t\t\t\tuserInfo: {}\r\n\t\t\t};\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\tthis.userInfo = useUserInfoStore().$state.userInfo\r\n\t\t},\r\n\t\tcomponents: {\r\n\t\t\tpageBack\r\n\t\t},\r\n\t\tonChooseAvatar(e) {\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '加载中...'\r\n\t\t\t});\r\n\t\t\tconst {\r\n\t\t\t\tavatarUrl\r\n\t\t\t} = e.detail;\r\n\t\t\tconst url = `${base_url}/user/editUserHeaders?id=${this.userInfo.id}`;\r\n\t\t\tconst token = uni.getStorageSync('token');\r\n\t\t\tuni.uploadFile({\r\n\t\t\t\turl: url,\r\n\t\t\t\tfilePath: avatarUrl,\r\n\t\t\t\tname: 'img',\r\n\t\t\t\theader: {\r\n\t\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded',\r\n\t\t\t\t\t'Authorization': token,\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: (uploadFileRes) => {\r\n\t\t\t\t\tthis.userInfo.avatarurl = avatarUrl;\r\n\t\t\t\t\tuseUserInfoStore().$patch({\r\n\t\t\t\t\t\tuserInfo: this.userInfo\r\n\t\t\t\t\t});\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: JSON.parse(uploadFileRes.data).message\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\t\t\t\tcomplete: () => {\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tloginOut() {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: \"退出登录中\"\r\n\t\t\t\t})\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\t\turl: \"/pages/mine/mine\"\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t\tthis.userInfo = {},\r\n\t\t\t\t\t\tuseUserInfoStore().$reset(),\r\n\t\t\t\t\t\tuni.hideLoading(),\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: \"成功退出登录\",\r\n\t\t\t\t\t\t\tmask: true\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\tuni.clearStorage()\r\n\t\t\t\t}, 1000)\r\n\t\t\t},\r\n\t\t\tupdateNickname(e) {\r\n\t\t\t\tconst newNickname = e.detail.value;\r\n\t\t\t\tif (!newNickname) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: \"昵称不能为空\",\r\n\t\t\t\t\t\ticon: \"error\"\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\teditNicknameAPI({\r\n\t\t\t\t\t\tname: newNickname,\r\n\t\t\t\t\t\tid: this.userInfo.id\r\n\t\t\t\t\t}).then((res) => {\r\n\t\t\t\t\t\tif (res.status == 200) {\r\n\t\t\t\t\t\t\tthis.userInfo.nickname = newNickname;\r\n\t\t\t\t\t\t\tuseUserInfoStore().$patch({\r\n\t\t\t\t\t\t\t\tuserInfo: this.userInfo\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: res.message,\r\n\t\t\t\t\t\t\t\ticon: \"success\"\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: \"昵称更新失败\" + res.message,\r\n\t\t\t\t\t\t\t\ticon: \"error\"\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).catch((err) => {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: err,\r\n\t\t\t\t\t\t\ticon: \"error\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\t.content {\r\n\t\tpadding-bottom: 200rpx;\r\n\t\tposition: relative;\r\n\t\ttop: 200rpx;\r\n\t\twidth: 100%;\r\n\t\tmin-height: 300rpx;\r\n\t\tbackground-color: rgb(255, 251, 241);\r\n\t\tborder-radius: 40rpx 40rpx 0 0;\r\n\t\toverflow: hidden;\r\n\t\tpadding: 40rpx 0;\r\n\r\n\t\t.infoHeader {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\r\n\t\t\t.avatar-wrapper {\r\n\t\t\t\tbackground-color: transparent;\r\n\t\t\t\tborder-radius: 100%;\r\n\t\t\t\tborder: none;\r\n\r\n\t\t\t\timage {\r\n\t\t\t\t\twidth: 200rpx;\r\n\t\t\t\t\theight: 200rpx;\r\n\t\t\t\t\tborder-radius: 100%;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t.user {\r\n\t\t\tpadding: 20rpx;\r\n\r\n\t\t\t.name {\r\n\t\t\t\twidth: 400rpx;\r\n\t\t\t\theight: 80rpx;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tmargin: auto;\r\n\r\n\t\t\t\tinput {\r\n\t\t\t\t\ttext-align: center;\r\n\t\t\t\t\tborder-bottom: 2rpx solid #dedede;\r\n\t\t\t\t\tpadding: 20rpx;\r\n\t\t\t\t\tfont-size: 36rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.loginOut {\r\n\t\tposition: absolute;\r\n\t\tbottom: 10%;\r\n\t\tleft: 50%;\r\n\t\ttransform: translateX(-50%);\r\n\t\twidth: 50%;\r\n\t\theight: 100rpx;\r\n\t\tbackground-color: #4d0000;\r\n\t\tcolor: #fffF;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tfont-size: 36rpx;\r\n\t\tborder-radius: 40rpx;\r\n\t}\r\n</style>","import MiniProgramPage from 'C:/Users/18706/Desktop/MZ/mazu-前端小程序/secondPages/accountSet/accountSet.vue'\nwx.createPage(MiniProgramPage)"],"names":["useUserInfoStore","uni","base_url","editNicknameAPI"],"mappings":";;;;;AAsBC,iBAAiB,MAAW;AAW5B,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,WAAW;AAAA,QACV,WAAW;AAAA,QACX,OAAO;AAAA,QACP,UAAU;AAAA,QACV,YAAY;AAAA,QACZ,UAAU;AAAA,MACV;AAAA,MACD,UAAU,CAAC;AAAA;EAEZ;AAAA,EACD,SAAS;AACR,SAAK,WAAWA,gCAAkB,EAAC,OAAO;AAAA,EAC1C;AAAA,EACD,YAAY;AAAA,IACX;AAAA,EACA;AAAA,EACD,eAAe,GAAG;AACjBC,kBAAAA,MAAI,YAAY;AAAA,MACf,OAAO;AAAA,IACR,CAAC;AACD,UAAM;AAAA,MACL;AAAA,QACG,EAAE;AACN,UAAM,MAAM,GAAGC,sBAAQ,4BAA4B,KAAK,SAAS,EAAE;AACnE,UAAM,QAAQD,cAAAA,MAAI,eAAe,OAAO;AACxCA,kBAAAA,MAAI,WAAW;AAAA,MACd;AAAA,MACA,UAAU;AAAA,MACV,MAAM;AAAA,MACN,QAAQ;AAAA,QACP,gBAAgB;AAAA,QAChB,iBAAiB;AAAA,MACjB;AAAA,MACD,SAAS,CAAC,kBAAkB;AAC3B,aAAK,SAAS,YAAY;AAC1BD,uBAAgB,iBAAA,EAAG,OAAO;AAAA,UACzB,UAAU,KAAK;AAAA,QAChB,CAAC;AACDC,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO,KAAK,MAAM,cAAc,IAAI,EAAE;AAAA,SACtC;AAAA,MACD;AAAA,MACD,UAAU,MAAM;AACfA,sBAAG,MAAC,YAAW;AAAA,MAChB;AAAA,IACD,CAAC;AAAA,EACD;AAAA,EACD,SAAS;AAAA,IACR,WAAW;AACVA,oBAAAA,MAAI,YAAY;AAAA,QACf,OAAO;AAAA,OACP;AACD,iBAAW,MAAM;AAChBA,sBAAAA,MAAI,UAAU;AAAA,UACZ,KAAK;AAAA,QACN,CAAC,GACD,KAAK,WAAW,CAAE,GAClBD,eAAgB,iBAAA,EAAG,OAAQ,GAC3BC,cAAAA,MAAI,YAAa,GACjBA,cAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,SACN;AACFA,sBAAAA,MAAI,aAAa;AAAA,MACjB,GAAE,GAAI;AAAA,IACP;AAAA,IACD,eAAe,GAAG;AACjB,YAAM,cAAc,EAAE,OAAO;AAC7B,UAAI,CAAC,aAAa;AACjBA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACP,CAAC;AAAA,aACK;AACNE,kCAAgB;AAAA,UACf,MAAM;AAAA,UACN,IAAI,KAAK,SAAS;AAAA,QACnB,CAAC,EAAE,KAAK,CAAC,QAAQ;AAChB,cAAI,IAAI,UAAU,KAAK;AACtB,iBAAK,SAAS,WAAW;AACzBH,2BAAgB,iBAAA,EAAG,OAAO;AAAA,cACzB,UAAU,KAAK;AAAA,YAChB,CAAC;AACDC,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO,IAAI;AAAA,cACX,MAAM;AAAA,YACP,CAAC;AAAA,iBACK;AACNA,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO,WAAW,IAAI;AAAA,cACtB,MAAM;AAAA,YACP,CAAC;AAAA,UACF;AAAA,QACD,CAAC,EAAE,MAAM,CAAC,QAAQ;AACjBA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,MAAM;AAAA,UACP,CAAC;AAAA,SACD;AAAA,MACF;AAAA,IACD;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;ACzID,GAAG,WAAW,eAAe;"}