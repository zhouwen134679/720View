{"version":3,"file":"topicDetail.js","sources":["secondPages/topicDetail/topicDetail.vue","E:/HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c2Vjb25kUGFnZXNcdG9waWNEZXRhaWxcdG9waWNEZXRhaWwudnVl"],"sourcesContent":["<template>\r\n\t<pageBack :titleInfo=\"titleInfo\"></pageBack>\r\n\t<view class=\"content\">\r\n\t\t<view class=\"infoContent\">\r\n\t\t\t<view class=\"info\">\r\n\t\t\t\t<view class=\"title\">\r\n\t\t\t\t\t<image :src=\"topicInfo?.cover\" mode=\"aspectFill\"></image>\r\n\t\t\t\t\t<view>\r\n\t\t\t\t\t\t#{{topicInfo?.name}}#\r\n\t\t\t\t\t\t<view class=\"data\">\r\n\t\t\t\t\t\t\t<text>动态 : {{postInfo?.length}}</text>\r\n\t\t\t\t\t\t\t<text>讨论人数 : {{topicInfo?.comment_count}}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"synopsis\" @click=\"showFullText\">\r\n\t\t\t\t\t<view v-if=\"!isShowingFullText\">\r\n\t\t\t\t\t\t{{topicInfo.description.slice(0, 30)}}... <text>点击展开</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view v-else>\r\n\t\t\t\t\t\t{{topicInfo.description}}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"postInfo\">\r\n\t\t\t<view class=\"tabList\">\r\n\t\t\t\t<view v-for=\"(item,index) in tabList\" :class=\"{active:tabCurrent === index}\"\r\n\t\t\t\t\t@click=\"chooseType(item.id,index)\">\r\n\t\t\t\t\t{{item.name}}\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"postContent\">\r\n\t\t\t\t<view class=\"item\" v-for=\"(item,index) in postInfo\">\r\n\t\t\t\t\t<view class=\"itemContent\">\r\n\t\t\t\t\t\t<view class=\"header\">\r\n\t\t\t\t\t\t\t<image :src=\"item.avatarurl\" mode=\"\"></image>\r\n\t\t\t\t\t\t\t<view>{{item.nickname}}</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"bottom\">\r\n\t\t\t\t\t\t\t<view class=\"info\">\r\n\t\t\t\t\t\t\t\t<view v-if=\"item.content.length < 100\" @click=\"showMore(item,index)\">\r\n\t\t\t\t\t\t\t\t\t<view v-html=\"item.content\"></view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<view v-else @click=\"showMore(item,index)\">\r\n\t\t\t\t\t\t\t\t\t<view v-if=\"!item.showMore\">\r\n\t\t\t\t\t\t\t\t\t\t<view v-html=\"item.content.slice(0,50)\"></view>\r\n\t\t\t\t\t\t\t\t\t\t<view style=\"text-align: right;\">\r\n\t\t\t\t\t\t\t\t\t\t\t<text>......</text>\r\n\t\t\t\t\t\t\t\t\t\t\t<text>双击展开</text>\r\n\t\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t\t<view v-else v-html=\"item.content\"></view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"container\">\r\n\t\t\t\t\t\t\t\t<view class=\"list\" v-for=\"(imgItem, imgIndex) in item.imageUrl\"\r\n\t\t\t\t\t\t\t\t\tv-if=\"item.imageUrl.length > 1\">\r\n\t\t\t\t\t\t\t\t\t<image :src=\"imgItem\" mode=\"aspectFill\"\r\n\t\t\t\t\t\t\t\t\t\t@click=\"previewImage(item.imageUrl, imgIndex)\">\r\n\t\t\t\t\t\t\t\t\t</image>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t\t<view class=\"list2\" v-for=\"(imgItem, imgIndex) in item.imageUrl\" v-else>\r\n\t\t\t\t\t\t\t\t\t<image :src=\"imgItem\" mode=\"aspectFill\"\r\n\t\t\t\t\t\t\t\t\t\t@click=\"previewImage(item.imageUrl, imgIndex)\">\r\n\t\t\t\t\t\t\t\t\t</image>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"separate\"></view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport pageBack from \"/components/title/title.vue\";\r\n\timport {\r\n\t\tgetTopicInfoAPI\r\n\t} from \"../../apis/community.js\"\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttitleInfo: {\r\n\t\t\t\t\ttitleShow: true,\r\n\t\t\t\t\ttitle: \"话题\",\r\n\t\t\t\t\timageUrl: \"http://t73sifiwt.hn-bkt.clouddn.com/pageBack/1.webp\",\r\n\t\t\t\t\theightShow: false,\r\n\t\t\t\t\tbackShow: true\r\n\t\t\t\t},\r\n\t\t\t\ttopicInfo: {},\r\n\t\t\t\tpostInfo: [],\r\n\t\t\t\tisShowingFullText: false,\r\n\t\t\t\ttabList: [{\r\n\t\t\t\t\t\tid: 1,\r\n\t\t\t\t\t\tname: \"默认\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: 2,\r\n\t\t\t\t\t\tname: \"最新发布\"\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tid: 3,\r\n\t\t\t\t\t\tname: \"热门发布\"\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\ttabCurrent: 0,\r\n\t\t\t\ttouchNum: 0\r\n\t\t\t};\r\n\t\t},\r\n\t\tcomponents: {\r\n\t\t\tpageBack\r\n\t\t},\r\n\t\tonLoad(option) {\r\n\t\t\tgetTopicInfoAPI({\r\n\t\t\t\tid: option.topicId\r\n\t\t\t}).then((res) => {\r\n\t\t\t\tthis.topicInfo = res.message.topic;\r\n\t\t\t\tthis.postInfo = res.message.postAndUser.map((item) => {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...item,\r\n\t\t\t\t\t\timageUrl: JSON.parse(item.imageUrl),\r\n\t\t\t\t\t\tshowMore: false\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\t\tonPageScroll(e) {\r\n\t\t\tif (e.scrollTop >= 80) {\r\n\t\t\t\tthis.titleInfo.heightShow = true;\r\n\t\t\t}\r\n\t\t\tif (e.scrollTop < 80) {\r\n\t\t\t\tthis.titleInfo.heightShow = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tshowFullText() {\r\n\t\t\t\tthis.isShowingFullText = !this.isShowingFullText;\r\n\t\t\t},\r\n\t\t\tchooseType(id, index) {\r\n\t\t\t\tthis.tabCurrent = index;\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: \"加载中\"\r\n\t\t\t\t})\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tif (id === 1) {\r\n\t\t\t\t\t\t// 随机排序\r\n\t\t\t\t\t\tthis.postInfo.sort(() => Math.random() - 0.5);\r\n\t\t\t\t\t} else if (id === 2) {\r\n\t\t\t\t\t\t// 将每一项时间取出进行排序\r\n\t\t\t\t\t\tthis.postInfo.sort((a, b) => new Date(b.time) - new Date(a.time));\r\n\t\t\t\t\t} else if (id === 3) {\r\n\t\t\t\t\t\t// 将每一项评论数量取出进行排序\r\n\t\t\t\t\t\tthis.postInfo.sort((a, b) => b.comment_count - a.comment_count);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t}, 500)\r\n\t\t\t},\r\n\t\t\tpreviewImage(urls, currentIndex) {\r\n\t\t\t\tuni.previewImage({\r\n\t\t\t\t\tcurrent: urls[currentIndex],\r\n\t\t\t\t\turls: urls\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tshowMore(item, index) {\r\n\t\t\t\tthis.touchNum++;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tif (this.touchNum === 1) {\r\n\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\turl: `/secondPages/communityDetail/communityDetail?postId=${item.post_id}`\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else if (this.touchNum >= 2) {\r\n\t\t\t\t\t\tthis.postInfo[index].showMore = !this.postInfo[index].showMore;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.touchNum = 0;\r\n\t\t\t\t}, 250);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\t.content {\r\n\t\tpadding-bottom: 200rpx;\r\n\t\tposition: relative;\r\n\t\ttop: 200rpx;\r\n\t\twidth: 100%;\r\n\t\tmin-height: 300rpx;\r\n\t\tbackground-color: rgb(255, 251, 241);\r\n\t\tborder-radius: 40rpx 40rpx 0 0;\r\n\t\toverflow: hidden;\r\n\r\n\t\t.infoContent {\r\n\t\t\twidth: 100%;\r\n\t\t\tpadding-top: 40rpx;\r\n\t\t\tpadding-bottom: 20rpx;\r\n\t\t\toverflow: hidden;\r\n\r\n\t\t\t.back {\r\n\t\t\t\ttop: 0;\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tfilter: blur(20px);\r\n\t\t\t}\r\n\r\n\t\t\t.info {\r\n\t\t\t\twidth: 90%;\r\n\t\t\t\tmargin: auto;\r\n\t\t\t\tposition: relative;\r\n\r\n\t\t\t\t.title {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t// align-items: center;\r\n\t\t\t\t\tfont-size: 46rpx;\r\n\t\t\t\t\tcolor: #4d0000;\r\n\r\n\t\t\t\t\timage {\r\n\t\t\t\t\t\twidth: 160rpx;\r\n\t\t\t\t\t\theight: 160rpx;\r\n\t\t\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t\t\t\tborder-radius: 4rpx;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.data {\r\n\t\t\t\t\t\tpadding: 20rpx 0;\r\n\t\t\t\t\t\tcolor: #a7a7a7;\r\n\t\t\t\t\t\tfont-size: 32rpx;\r\n\r\n\t\t\t\t\t\ttext {\r\n\t\t\t\t\t\t\tmargin-right: 30rpx;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.synopsis {\r\n\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\tpadding: 20rpx 0;\r\n\t\t\t\t\tcolor: #888888;\r\n\t\t\t\t\tletter-spacing: 2rpx;\r\n\t\t\t\t\tfont-size: 34rpx;\r\n\t\t\t\t\toverflow: hidden;\r\n\t\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\t\tline-height: 52rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.postInfo {\r\n\t\t\t.tabList {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\twidth: 90%;\r\n\t\t\t\tmargin: auto;\r\n\r\n\t\t\t\tview {\r\n\t\t\t\t\tpadding: 10rpx 20rpx;\r\n\t\t\t\t\tborder-radius: 20rpx;\r\n\t\t\t\t\tmargin-right: 20rpx;\r\n\r\n\t\t\t\t\t&.active {\r\n\t\t\t\t\t\tbackground-color: #4d0000;\r\n\t\t\t\t\t\tcolor: #fff;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.postContent {\r\n\t\t\t\tpadding: 40rpx 0;\r\n\r\n\t\t\t\t.item {\r\n\t\t\t\t\tpadding: 20rpx 0;\r\n\r\n\t\t\t\t\t.itemContent {\r\n\t\t\t\t\t\twidth: 90%;\r\n\t\t\t\t\t\tmargin: auto;\r\n\r\n\t\t\t\t\t\t.header {\r\n\t\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\t\t\t\talign-items: center;\r\n\t\t\t\t\t\t\twidth: 100%;\r\n\r\n\t\t\t\t\t\t\timage {\r\n\t\t\t\t\t\t\t\twidth: 60rpx;\r\n\t\t\t\t\t\t\t\theight: 60rpx;\r\n\t\t\t\t\t\t\t\tborder-radius: 100%;\r\n\t\t\t\t\t\t\t\tmargin-right: 20rpx;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t.info {\r\n\t\t\t\t\t\t\tpadding: 20rpx 0;\r\n\r\n\t\t\t\t\t\t\ttext {\r\n\t\t\t\t\t\t\t\tcolor: #888888;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t.container {\r\n\t\t\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t.list {\r\n\t\t\t\t\t\t\twidth: 32%;\r\n\t\t\t\t\t\t\taspect-ratio: 1;\r\n\r\n\t\t\t\t\t\t\timage {\r\n\t\t\t\t\t\t\t\t// width: 100%;\r\n\t\t\t\t\t\t\t\t// height: 100%;\r\n\t\t\t\t\t\t\t\twidth: 210rpx;\r\n\t\t\t\t\t\t\t\theight: 210rpx;\r\n\t\t\t\t\t\t\t\tborder-radius: 10rpx;\r\n\t\t\t\t\t\t\t\t// margin-top: 10rpx;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t.list:not(:nth-child(3n)) {\r\n\t\t\t\t\t\t\tmargin-right: calc(5% / 3);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t.list2 {\r\n\t\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t\t\taspect-ratio: 1;\r\n\r\n\t\t\t\t\t\t\timage {\r\n\t\t\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t\t\t\theight: 100%;\r\n\t\t\t\t\t\t\t\tborder-radius: 10rpx;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.separate {\r\n\t\t\t\t\t\tmargin: 40rpx 0 20rpx 0;\r\n\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t\theight: 20rpx;\r\n\t\t\t\t\t\tbackground-color: rgba(0, 0, 0, 0.04);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'D:/01前端学习/01fzhx/mazu-2/mazu-2/mazu-前端小程序/secondPages/topicDetail/topicDetail.vue'\nwx.createPage(MiniProgramPage)"],"names":["getTopicInfoAPI","uni"],"mappings":";;;;;EAoFE,OAAA;AACC,WAAA;AAAA;QAEE,WAAA;AAAA;QAEA,UAAA;AAAA,QACA,YAAA;AAAA;;;;;MAMD,SAAA;AAAA,QAAA;AAAA;UAEE,MAAA;AAAA;QAED;AAAA;;;QAIA;AAAA;;QAGA;AAAA;;MAGD,UAAA;AAAA;;;IAID;AAAA;EAED,OAAA,QAAA;AACCA,mCAAA;AAAA,MACC,IAAA,OAAA;AAAA,IACD,CAAA,EAAA,KAAA,CAAA,QAAA;AACC,WAAA,YAAA,IAAA,QAAA;;AAEC,eAAA;AAAA,UACC,GAAA;AAAA,UACA,UAAA,KAAA,MAAA,KAAA,QAAA;AAAA;;MAGF,CAAA;AAAA,IACD,CAAA;AAAA;EAED,aAAA,GAAA;AACC,QAAA,EAAA,aAAA,IAAA;AACC,WAAA,UAAA,aAAA;AAAA,IACD;AACA,QAAA,EAAA,YAAA,IAAA;AACC,WAAA,UAAA,aAAA;AAAA,IACD;AAAA;EAED,SAAA;AAAA,IACC,eAAA;;;IAGA,WAAA,IAAA,OAAA;AACC,WAAA,aAAA;AACAC,oBAAAA,MAAA,YAAA;AAAA;;AAGA,iBAAA,MAAA;;AAGE,eAAA,SAAA,KAAA,MAAA,KAAA,OAAA,IAAA,GAAA;AAAA,QACD,WAAA,OAAA,GAAA;;QAGA,WAAA,OAAA,GAAA;;QAGA;AACAA,sBAAAA,MAAA,YAAA;AAAA;;IAGF,aAAA,MAAA,cAAA;AACCA,oBAAAA,MAAA,aAAA;AAAA;QAEC;AAAA,MACD,CAAA;AAAA;IAED,SAAA,MAAA,OAAA;AACC,WAAA;AACA,iBAAA,MAAA;AACC,YAAA,KAAA,aAAA,GAAA;AACCA,wBAAAA,MAAA,WAAA;AAAA,YACC,KAAA,uDAAA,KAAA,OAAA;AAAA,UACD,CAAA;AAAA;;QAGD;AACA,aAAA,WAAA;AAAA,MACD,GAAA,GAAA;AAAA,IACD;AAAA,EACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnLF,GAAG,WAAW,eAAe;"}