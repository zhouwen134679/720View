{"version":3,"file":"login.js","sources":["pages/login/login.vue","E:/HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<template>\r\n\t<view class=\"content\">\r\n\t\t<image class=\"imageBack\"\r\n\t\t\tsrc=\"http://t73sifiwt.hn-bkt.clouddn.com/index/1040g2sg3170fnkhck4dg5p68qdqap5st2d183v0%21nd_dft_wlteh_webp_3.webp\"\r\n\t\t\tmode=\"aspectFill\">\r\n\t\t</image>\r\n\t\t<view class=\"logo\">\r\n\t\t\t<image src=\"../../static/logo.png\" mode=\"\"></image>\r\n\t\t\t<view class=\"text\">\r\n\t\t\t\t福泽海韵\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"loginBtn\" @click=\"login\">\r\n\t\t\t微信登录\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tgetOpenIdAPI,\r\n\t\twxLoginAPI,\r\n\t\tuserVisitCountAPI\r\n\t} from \"@/apis/user.js\"\r\n\timport {\r\n\t\tuseUserInfoStore\r\n\t} from \"@/store/userInfo.js\"\r\n\timport {\r\n\t\tuseCounterStore\r\n\t} from \"@/store/switchTab.js\";\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tback() {\r\n\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\tdelta: 1\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tlogin() {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\tmask: true,\r\n\t\t\t\t\ttitle: '登陆中'\r\n\t\t\t\t})\r\n\t\t\t\tuni.login({\r\n\t\t\t\t\tprovider: 'weixin',\r\n\t\t\t\t\tsuccess: function(loginRes) {\r\n\t\t\t\t\t\t// 登录成功\r\n\t\t\t\t\t\tuni.getUserInfo({\r\n\t\t\t\t\t\t\tprovider: 'weixin',\r\n\t\t\t\t\t\t\tsuccess: function(info) {\r\n\t\t\t\t\t\t\t\tgetOpenIdAPI(loginRes.code).then((res) => {\r\n\t\t\t\t\t\t\t\t\tif (res.status == 200) {\r\n\t\t\t\t\t\t\t\t\t\twxLoginAPI({\r\n\t\t\t\t\t\t\t\t\t\t\topenid: res.message.openid,\r\n\t\t\t\t\t\t\t\t\t\t\tnickname: info.userInfo.nickName,\r\n\t\t\t\t\t\t\t\t\t\t\tavatarurl: info.userInfo.avatarUrl,\r\n\t\t\t\t\t\t\t\t\t\t\tgender: info.userInfo.gender\r\n\t\t\t\t\t\t\t\t\t\t}).then((res) => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (res.status == 200) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.setStorageSync('isLoggedIn',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttrue);\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.setStorageSync('token',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tres.token);\r\n\t\t\t\t\t\t\t\t\t\t\t\tuseUserInfoStore().$state\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.userInfo = res.user\r\n\t\t\t\t\t\t\t\t\t\t\t\tuseCounterStore().$state\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.currentTab = 4;\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\turl: \"/pages/mine/mine\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t}, 1000)\r\n\t\t\t\t\t\t\t\t\t\t\t\tuserVisitCountAPI(res.user.id)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(res\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.message);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: '登录成功',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmask: true\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle: res.message,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon: \"error\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: res.message.errmsg,\r\n\t\t\t\t\t\t\t\t\t\t\ticon: \"error\"\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}).catch((err) => {\r\n\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\ttitle: err,\r\n\t\t\t\t\t\t\t\t\t\ticon: \"error\"\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: function(err) {\r\n\t\t\t\t\t\t// 登录授权失败\r\n\t\t\t\t\t\t// err.code是错误码\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: err,\r\n\t\t\t\t\t\t\ticon: \"error\"\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n\t.content {\r\n\t\theight: 100vh;\r\n\t\twidth: 100vw;\r\n\t\tposition: relative;\r\n\t\tfont-family: \"妈祖祖庙\" !important;\r\n\r\n\t\t.imageBack {\r\n\t\t\theight: 100%;\r\n\t\t\twidth: 100%;\r\n\t\t\tposition: absolute;\r\n\t\t}\r\n\r\n\t\t.logo {\r\n\t\t\tposition: absolute;\r\n\t\t\ttop: 15%;\r\n\t\t\tleft: 50%;\r\n\t\t\ttransform: translateX(-50%);\r\n\t\t\tcolor: #fff;\r\n\r\n\t\t\timage {\r\n\t\t\t\twidth: 240rpx;\r\n\t\t\t\theight: 240rpx;\r\n\t\t\t\tborder-radius: 20rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.text {\r\n\t\t\t\ttext-align: center;\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t\tfont-size: 60rpx;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.loginBtn {\r\n\t\t\tcolor: #4d0000;\r\n\t\t\tfont-size: 46rpx;\r\n\t\t\tpadding: 10rpx 20rpx;\r\n\t\t\twidth: 450rpx;\r\n\t\t\theight: 80rpx;\r\n\t\t\tbackground-color: #f8f8f8;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\t\t\tborder-radius: 100rpx;\r\n\t\t\tposition: absolute;\r\n\t\t\tbottom: 15%;\r\n\t\t\tleft: 50%;\r\n\t\t\ttransform: translateX(-50%);\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'D:/01前端学习/01fzhx/mazu-2/mazu-2/mazu-前端小程序/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","getOpenIdAPI","wxLoginAPI","res","useUserInfoStore","useCounterStore","userVisitCountAPI"],"mappings":";;;;;;AA8BC,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;EAGP;AAAA,EACD,SAAS;AAAA,IACR,OAAO;AACNA,oBAAAA,MAAI,aAAa;AAAA,QAChB,OAAO;AAAA,OACP;AAAA,IACD;AAAA,IACD,QAAQ;AACPA,oBAAAA,MAAI,YAAY;AAAA,QACf,MAAM;AAAA,QACN,OAAO;AAAA,OACP;AACDA,oBAAAA,MAAI,MAAM;AAAA,QACT,UAAU;AAAA,QACV,SAAS,SAAS,UAAU;AAE3BA,wBAAAA,MAAI,YAAY;AAAA,YACf,UAAU;AAAA,YACV,SAAS,SAAS,MAAM;AACvBC,wBAAAA,aAAa,SAAS,IAAI,EAAE,KAAK,CAAC,QAAQ;AACzC,oBAAI,IAAI,UAAU,KAAK;AACtBC,uCAAW;AAAA,oBACV,QAAQ,IAAI,QAAQ;AAAA,oBACpB,UAAU,KAAK,SAAS;AAAA,oBACxB,WAAW,KAAK,SAAS;AAAA,oBACzB,QAAQ,KAAK,SAAS;AAAA,kBACvB,CAAC,EAAE,KAAK,CAACC,SAAQ;AAChB,wBAAIA,KAAI,UAAU,KAAK;AACtBH,oCAAG,MAAC;AAAA,wBAAe;AAAA,wBAClB;AAAA,sBAAI;AACLA,oCAAG,MAAC;AAAA,wBAAe;AAAA,wBAClBG,KAAI;AAAA,sBAAK;AACVC,qCAAAA,iBAAkB,EAAC,OACjB,WAAWD,KAAI;AACjBE,sCAAAA,gBAAiB,EAAC,OAChB,aAAa;AACf,iCAAW,MAAM;AAChBL,sCAAAA,MAAI,UAAU;AAAA,0BACb,KAAK;AAAA,yBACL;AAAA,sBACD,GAAE,GAAI;AACPM,kDAAkBH,KAAI,KAAK,EAAE,EAC3B,KAAK,CAACA,SAAQ;AACdH,sCAAAA,kDAAYG,KACV,OAAO;AACTH,sCAAAA,MAAI,UAAU;AAAA,0BACb,OAAO;AAAA,0BACP,MAAM;AAAA,yBACN;AAAA,uBACD;AAAA,2BACI;AACNA,oCAAAA,MAAI,UAAU;AAAA,wBACb,OAAOG,KAAI;AAAA,wBACX,MAAM;AAAA,uBACN;AAAA,oBACF;AAAA,mBACA;AAAA,uBACK;AACNH,gCAAAA,MAAI,UAAU;AAAA,oBACb,OAAO,IAAI,QAAQ;AAAA,oBACnB,MAAM;AAAA,mBACN;AAAA,gBACF;AAAA,cACD,CAAC,EAAE,MAAM,CAAC,QAAQ;AACjBA,8BAAAA,MAAI,UAAU;AAAA,kBACb,OAAO;AAAA,kBACP,MAAM;AAAA,iBACN;AAAA,eACD;AAAA,YACF;AAAA,WACA;AAAA,QACD;AAAA,QACD,MAAM,SAAS,KAAK;AAGnBA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,MAAM;AAAA,WACN;AAAA,QACD;AAAA,MACF,CAAC;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;ACrHD,GAAG,WAAW,eAAe;"}