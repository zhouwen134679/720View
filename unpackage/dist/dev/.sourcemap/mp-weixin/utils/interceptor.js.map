{"version":3,"file":"interceptor.js","sources":["utils/interceptor.js"],"sourcesContent":["const whiteList = [\r\n\t'/secondPages/news/news',\r\n\t'/secondPages/faith/faith',\r\n\t'/secondPages/cultureCreativity/cultureCreativity',\r\n\t'/secondPages/fuCulture/fuCulture',\r\n\t'/secondPages/mazuCulture/mazuCulture',\r\n\t'/secondPages/palaceTemple/palaceTemple',\r\n\t'/secondPages/publication/publication',\r\n\t'/secondPages/tourism/tourism',\r\n\t'/secondPages/gridDetail/gridDetail',\r\n\t'/secondPages/communityDetail/communityDetail',\r\n\t'/secondPages/topicDetail/topicDetail',\r\n\t'/secondPages/search/search',\r\n\t'/secondPages/shopDetail/shopDetail',\r\n\t'/secondPages/contact/contact',\r\n\t// 开发所需\r\n\t// '/secondPages/commitOrder/commitOrder',\r\n\t// '/secondPages/setAddress/setAddress',\r\n\t// '/secondPages/addAddress/addAddress',\r\n\t'/secondPages/praysDetail/praysDetail'\r\n];\r\n\r\nlet navigateToCount = 0;\r\n\r\nfunction hasPermission(url) {\r\n\t// 从本地存储中获取登录状态  \r\n\tconst isLoggedIn = uni.getStorageSync('isLoggedIn');\r\n\r\n\t// 仅获取 URL 的路径部分（去掉参数）  \r\n\tconst urlPath = url.split('?')[0];\r\n\r\n\t// 如果 URL 在白名单中或用户已登录, 则允许访问  \r\n\treturn whiteList.includes(urlPath) || isLoggedIn;\r\n}\r\n\r\nuni.addInterceptor('navigateTo', {\r\n\tinvoke(e) {\r\n\t\tif (!hasPermission(e.url)) {\r\n\t\t\t// 递增 navigateToCount  \r\n\t\t\tnavigateToCount++;\r\n\r\n\t\t\t// 如果计数小于 2, 导航登录页面  \r\n\t\t\tif (navigateToCount < 2) {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/pages/login/login'\r\n\t\t\t\t});\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\t// 重置计数  \r\n\t\t\t\tnavigateToCount = 0;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\tsuccess(e) {\r\n\t\t// 处理导航成功的情况  \r\n\t}\r\n});"],"names":["uni"],"mappings":";;AAAA,MAAM,YAAY;AAAA,EACjB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA;AAAA;AAAA;AAAA,EAKA;AACD;AAEA,IAAI,kBAAkB;AAEtB,SAAS,cAAc,KAAK;AAE3B,QAAM,aAAaA,cAAAA,MAAI,eAAe,YAAY;AAGlD,QAAM,UAAU,IAAI,MAAM,GAAG,EAAE,CAAC;AAGhC,SAAO,UAAU,SAAS,OAAO,KAAK;AACvC;AAEAA,cAAAA,MAAI,eAAe,cAAc;AAAA,EAChC,OAAO,GAAG;AACT,QAAI,CAAC,cAAc,EAAE,GAAG,GAAG;AAE1B;AAGA,UAAI,kBAAkB,GAAG;AACxBA,sBAAAA,MAAI,WAAW;AAAA,UACd,KAAK;AAAA,QACV,CAAK;AACD,eAAO;AAAA,MACX,OAAU;AAEN,0BAAkB;AAClB,eAAO;AAAA,MACP;AAAA,IACD;AACD,WAAO;AAAA,EACP;AAAA,EACD,QAAQ,GAAG;AAAA,EAEV;AACF,CAAC;"}